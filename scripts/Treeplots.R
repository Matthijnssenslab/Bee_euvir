library("ggtree")
library("ggplot2")
library("phytools")
library("viridis")
library("svglite")
library("gridExtra")
library("treeio")

setwd("/Users/deboutte/Bioinf/repo/Bee_euvir")


# Bunya -------------------------------------------------------------------
bunya <- read.mrbayes("data/cons_trees/bunya.nex.con.tre")

# Bunya Colors ------------------------------------------------------------
cls <- list(Unclassified = c('KX884775.1_1',
                             'KX884805.1_1',
                             'KX884807.1_1',
                             'MF176242.1_1',
                             'MF176293.1_1',
                             'MF176313.1_1',
                             'MF176329.1_1',
                             'MF176353.1_1',
                             'MF176372.1_1',
                             'MN168168.1_1',
                             'NC_040759.1_1',
                             'NC_032151.1_1'),
            Phasmaviridae = c('KJ434182.1_1',
                              'KM817697.1_1',
                              'KM817698.1_2',
                              'MH822966.1_1',
                              'NC_031307.1_1',
                              'NC_031312.1_2',
                              'NC_034462.1_1',
                              'NC_043642.1_1'),
            Peribunyaviridae = c('KY354237.1_1', 'SRR5109820.Contig_13922_1091.96_length_6449_1'),
            SRA = c('SRR1812786.Contig_29604_62.7809_length_6336_1','SRR2664950.Contig_23840_14.7864_length_6215_1'))
cols <- c("0" ="#7f7f7f", "Unclassified" = "#7f7f7f","SRA" = "#ff7f0e",
          "Phasmaviridae" = "#2ca02c","Peribunyaviridae" = "#2ca02c")

# Bunya Plot --------------------------------------------------------------
bunya@phylo <- midpoint.root(bunya@phylo)
bunya <- groupOTU(bunya, cls)
bunyatree <- ggtree(bunya, aes(color=group), size=1) +
  #geom_nodelab(aes(label=round(as.numeric(posterior), 2)),alpha=0.5,color='black', size=2, nudge_x=0.01) +
  geom_nodepoint(aes(subset = prob > 0.8), color='black',size=2) + 
  geom_tiplab() + 
  #theme(legend.position = c(0.1,0.9), 
  #      legend.title = element_blank(), # no title
  #      legend.key = element_blank()) +
  xlim(0, 2) +
  geom_treescale() + 
  scale_colour_manual(values = cols)
bunyatree
ggsave("treePlots/bunya.svg",bunyatree, device = "svg", dpi=300)
ggsave("treePlots/bunya.pdf",bunyatree, device = "pdf", dpi=300)

# Orthomyxo_Bee -----------------------------------------------------------
orthobee <- read.mrbayes("data/cons_trees/orthomyxo_bee.nex.con.tre")


# Orthomyxo_Bee Colors ----------------------------------------------------
cls <- list(NODE = c('BP46_PB2PB1PANP','BP47_PB2PB1PANP','BP49_PB2PB1PANP'),
            Influenza = c('AB126193_Influenza_C','FJ969536_Influenza_A','M14880_Influenza_B'),
            Thogotolike = c('GU969313_Dhori','HM627174_Jos','KC506156_Upolu','KC506162_Aransas_Bay','KU708253_Bourbon','Y17873_Thogoto'),
            Quaranja = c('KM114304_Wellfleet_Bay','KX883865_Wuhan_Mosquito_4','KX883876_Jingshan_fly_1','KX883879_Sanxia_water_Strider_3'),
            Isavirus = c('KU587572_Infectious_salmon_anemia'),
            Unclassified = c('KX882061_Rainbow_trout_orthomyxovirus-1','KX882069_Steelhead_trout_orthomyxovirus-1','KX883845_Beihai_orthomyxo-like_1','KX883859_Hubei_earwig_1','KX883884_Hubei_orthoptera_6','KX949591_Sinu','Hubei_orthomyxo-like_2'))
cols <- c("0" ="#7f7f7f", "Unclassified" = "#7f7f7f","NODE" = "#ff7f0e", "Influenza" = "#2ca02c","Thogotolike"="#2ca02c", "Quaranja"="#2ca02c", "Isavirus"="#2ca02c")
cols2 <- c("0"="blue","Unclassified" = "#7f7f7f","NODE" = "#ff7f0e", "Influenza" = "red","Thogotolike"="purple", "Quaranja"="yellow", "Isavirus"="black")

# Orthomyxo_Bee Plot ------------------------------------------------------
orthobee@phylo <- midpoint.root(orthobee@phylo)
orthobee <- groupOTU(orthobee, cls)
orthobeetree <- ggtree(orthobee, aes(color=group), size=1) +
  #geom_nodelab(aes(label=round(as.numeric(posterior), 2)),alpha=0.5,color='black', size=2, nudge_x=0.01) +
  geom_nodepoint(aes(subset = prob > 0.8), color='black',size=2) + 
  geom_tiplab() + 
  #theme(legend.position = c(0.1,0.9), 
  #      legend.title = element_blank(), # no title
  #      legend.key = element_blank()) +
  xlim(0,4) + 
  geom_treescale() + 
  scale_colour_manual(values = cols)
orthobeetree
ggsave("treePlots/orthobee.svg",orthobeetree, device = "svg", dpi=300)
ggsave("treePlots/orthobee.pdf",orthobeetree, device = "pdf", dpi=300)


# Orthomyxo_SRA ---------------------------------------------------------------
orthosra <- read.mrbayes("data/cons_trees/orthomyxo_sra.nex.con.tre")

# Orthomyxo_SRA Colors ----------------------------------------------------
cls <- list(NODE = c('BP46_NODE_59_length_2296_cov_1606.73_PB1_1'),
            SRA = c('SRR2064700.Contig_7931_28.6803_length_2416_1',
                    'SRR2916026.Contig_21490_12.8872_length_2343_1',
                    'SRR3993646.Contig_4218_61.3183_length_2345_1',
                    'SRR4301486.Contig_8416_72.6801_length_2424_1',
                    'SRR5885442.Contig_31234_55.8986_length_1924_1',
                    'SRR6001380.Contig_6081_137. 105_length_2095_1',
                    'SRR770031.Contig_2318_75.597_length_2397_1'),
            delta = c('KM392504.1',
                      'KX768818.1'),
            alpha = c('CY035132.1',
                      'CY103874.1',
                      'JQ994252.1',
                      'KJ856190.1'),
            beta = c('CY171757.1',
                     'D00004.1',
                     'EF626634.1',
                     'KX351451.1',
                     'MH684310.1'),
            gamma = c('NC_006308.2'),
            thogoto = c('AF004985.1',
                        'HM627170.1',
                        'KC506157.1',
                        'KC506163.1',
                        'KU708254.1',
                        'KX670390.1',
                        'LC010982.1',
                        'M65866.1',
                        'NC_040731.1'),
            quaranja = c('KM114305.1',
                         'KM817616.1',
                         'KM817617.1',
                         'KM817619.1',
                         'KM817620.1',
                         'KM817621.1',
                         'KM817622.1',
                         'KM817623.1',
                         'KM817624.1',
                         'KM817625.1',
                         'KM817626.1',
                         'KM817627.1',
                         'KX883875.1',
                         'MG770333.1',
                         'MH267793.1',
                         'MH558140.1',
                         'MN053836.1',
                         'MN053837.1',
                         'MN053838.1'),
            unclass = c('JQ928944.1',
                        'KX883844.1',
                        'KX883858.1',
                        'KX883868.1',
                        'KX883873.1',
                        'KX883874.1',
                        'KX883884.1',
                        'KX898491.1',
                        'KX949590.1',
                        'MF176325.1',
                        'MG600038.1',
                        'MG972988.1',
                        'MG972993.1',
                        'MK026596.1',
                        'MK227173.1',
                        'MN167480.1'))
cols <- c("0" ="#7f7f7f", "unclass" = "#7f7f7f","NODE" = "#ff7f0e","SRA"="#1f77b4", "gamma"="#2ca02c","alpha"="#2ca02c","beta"="#2ca02c","delta"="#2ca02c","thogoto"="#2ca02c","quaranja"="#2ca02c")
cols2 <- c("0" ="#7f7f7f", "unclass" = "#7f7f7f","NODE" = "#ff7f0e","SRA"="#1f77b4", "gamma"="red","alpha"="red","beta"="red","delta"="red","thogoto"="blue","quaranja"="purple")

# Orthomyxo_SRA Plot ------------------------------------------------------
orthosra@phylo <- midpoint.root(orthosra@phylo)
orthosra <- groupOTU(orthosra, cls)
orthosratree <- ggtree(orthosra, aes(color=group), size=1) +
  #geom_nodelab(aes(label=round(as.numeric(posterior), 2)),alpha=0.5,color='black', size=2, nudge_x=0.01) +
  geom_nodepoint(aes(subset = prob > 0.8), color='black',size=2) + 
  geom_tiplab() + 
  #theme(legend.position = c(0.1,0.9), 
  #      legend.title = element_blank(), # no title
  #      legend.key = element_blank()) +
  xlim(0,4) + 
  geom_treescale() + 
  scale_colour_manual(values = cols)
orthosratree
ggsave("treePlots/orthosra.svg",orthosratree, device = "svg", dpi=300)
ggsave("treePlots/orthosra.pdf",orthosratree, device = "pdf", dpi=300)


# Partiti -----------------------------------------------------------------
partiti <- read.mrbayes("data/cons_trees/partiti.nex.con.tre")

# Partiti Colors ----------------------------------------------------------
cls <- list(NODE = c('BP15_NODE_21_length_1989_cov_11_700214_1',
                     'BP23_NODE_181_length_1578_cov_4_697323',
                     'BP2_NODE_11_length_2442_cov_8_707023',
                     'BP48_NODE_37_length_1861_cov_5_466667_1',
                     'BeeP-11-2013_NODE_907_length_1923_cov_7_401408_1',
                     'BeeP-32-2013_NODE_32_length_2325_cov_12_654359_1',
                     'BeeP-32-2013_NODE_58_length_1715_cov_25_394994_1',
                     'BeeP-33-2013_NODE_5_length_2414_cov_84_842533_1',
                     'BeeP-35-2013_NODE_401_length_2385_cov_62_380849_1',
                     'BeeP-35-2013_NODE_620_length_1910_cov_20_108565_1',
                     'BeeP-35-2013_NODE_899_length_1547_cov_109_939456_2',
                     'BeeP-37-2013_NODE_115_length_2447_cov_879_975527_1',
                     'BeeP-37-2013_NODE_116_length_2446_cov_659_816800_1',
                     'BeeP-37-2013_NODE_164_length_1939_cov_93_179914_1',
                     'BeeP-44-2013_NODE_110_length_1821_cov_96_515482_1',
                     'BeeP-44-2013_NODE_146_length_1607_cov_51_104575_1',
                     'BeeP-44-2013_NODE_94_length_1947_cov_31_678610_1',
                     'BeeP-44-2013_NODE_99_length_1913_cov_780_763617_1',
                     'BeeP-47-2013_NODE_67_length_1854_cov_32_899268_1',
                     'BeeP-47-2013_NODE_88_length_1610_cov_66_399870_1',
                     'BeeP-49-2013_NODE_249_length_1887_cov_3011_785635_1',
                     'BeeP-49-2013_NODE_255_length_1857_cov_503_888202_1',
                     'BeeP-49-2013_NODE_262_length_1819_cov_24_860505_1',
                     'BeeP-49-2013_NODE_307_length_1700_cov_116_550832_1'),
            SRA = c('ERR1354112.Contig_10743_83.2701_length_2186_2',
                    'SRR4002881.Contig_4619_145.602_length_2331_1'),
            Alpha = c('NC_038827.1_1',
                      'NC_038829.1_1',
                      'NC_038831.1_1',
                      'NC_038834.1_1',
                      'NC_038836.1_2'),
            Beta = c('NC_003801.1_1',
                     'NC_007537.1_1',
                     'NC_013109.1_1',
                     'NC_021094.1_1',
                     'NC_021096.1_1',
                     'NC_021098.1_1',
                     'NC_021147.1_1',
                     'NC_028251.1_1',
                     'NC_030882.1_1',
                     'NC_031134.1_1',
                     'NC_035485.1_1',
                     'NC_038837.1_1'),
            Gamma = c('NC_005976.2_1',
                      'NC_040387.1_1'),
            Unclassified = c('NC_013014.1_1',
                             'NC_021873.1_1',
                             'NC_030875.1_1',
                             'NC_030878.1_1',
                             'NC_030889.1_1',
                             'NC_034514.1_1',
                             'NC_040483.1_1',
                             'NC_040496.1_1'))
cols <- c("NODE" = "#ff7f0e","SRA" = "#1f77b4","Alpha" = "#2ca02c","Beta" = "#2ca02c","Gamma" = "#2ca02c","Unclassified" = "#7f7f7f", "0" = "#7f7f7f")
cols2 <- c("NODE" = "#ff7f0e","SRA" = "#1f77b4","Alpha" = "red","Beta" = "blue","Gamma" = "purple","Unclassified" = "#7f7f7f", "0" = "#7f7f7f")

# Partiti Plot ------------------------------------------------------------
partiti@phylo <- midpoint.root(partiti@phylo)
partiti <- groupOTU(partiti, cls)
partititree <- ggtree(partiti, aes(color=group), size=1) +
  #geom_nodelab(aes(label=round(as.numeric(posterior), 2)),alpha=0.5,color='black', size=2, nudge_x=0.01) +
  geom_nodepoint(aes(subset = prob > 0.8), color='black',size=2) + 
  geom_tiplab() + 
  #theme(legend.position = c(0.1,0.9), 
  #      legend.title = element_blank(), # no title
  #      legend.key = element_blank()) +
  xlim(0,4) + 
  geom_treescale() + 
  scale_colour_manual(values = cols)
partititree
ggsave("treePlots/partiti.svg",partititree, device = "svg", dpi=300)
ggsave("treePlots/partiti.pdf",partititree, device = "pdf", dpi=300)

# Hepe-astro-NS ---------------------------------------------------------

astrohepe <- read.mrbayes("data/cons_trees/astrohepe.nex.con.tre")

# Hepe-astro-NS Colors ----------------------------------------------------

cls <- list(NODE = c('BeeP_49_2013_NODE_27_length_6327_cov_6_608480_3'),
            Alphatetraviridae = c('EU345431.1_1','KX423453.1_1','NC_001981.1_1','NC_005898.1_1','U18246.1_1','AY594352.1_1'),
            Astroviridae = c('KX907135.1_1','NC_032426.1_1','NC_040647.1_1'),
            Hepeviridae = c('MF190001.1_1','NC_040710.1_1'),
            Bromoviridae = c('NC_009537.1_1'))
cols <- c("NODE" = "#ff7f0e","Alphatetraviridae"="#2ca02c","Astroviridae"="#2ca02c","Hepeviridae"="#2ca02c","Bromoviridae"="#2ca02c")


# Hepe-astro-NS Plot ------------------------------------------------------

astrohepe@phylo <- midpoint.root(astrohepe@phylo)
astrohepe <- groupOTU(astrohepe, cls)
astrohepetree <- ggtree(astrohepe, aes(color=group), size=1) +
  #geom_nodelab(aes(label=round(as.numeric(posterior), 2)),alpha=0.5,color='black', size=2, nudge_x=0.01) +
  geom_nodepoint(aes(subset = prob > 0.8), color='black',size=2) + 
  geom_tiplab() + 
  #theme(legend.position = c(0.1,0.9), 
  #      legend.title = element_blank(), # no title
  #      legend.key = element_blank()) +
  xlim(0,4) + 
  geom_treescale() + 
  scale_colour_manual(values = cols)
astrohepetree
ggsave("treePlots/astrohepe.svg",astrohepetree, device = "svg", dpi=300)
ggsave("treePlots/astrohepe.pdf",astrohepetree, device = "pdf", dpi=300)


# SinaiS-AA ---------------------------------------------------------------

sinais <- read.mrbayes("data/cons_trees/sinais-aa.nex.con.tre")


# SinaiS-AA Colors --------------------------------------------------------
cls <- list(NODE = c('BP11_NODE_2_length_5933_cov_8664_753785_2', 
                     'BP35_NODE_8_length_6159_cov_3073_471514_3',
                     'BeeP_34_2013_NODE_11_length_5700_cov_81_138894_3',
                     'BeeP_34_2013_NODE_8_length_5876_cov_117_977410_3'),
            SRA = c('SRR1239309.Contig_10906_56.5422_length_5835_3', 'SRR1239309.Contig_3402_33.8366_length_5852_3', 'SRR1239310.Contig_18500_86.3069_length_5976_3', 'SRR3927501.Contig_20_4621.33_length_5753_3', 'SRR5109829.Contig_5052_19.3642_length_5832_3', 'SRR5117449.Contig_4792_738.395_length_5543_3', 'SRR6031640.Contig_16980_3187.18_length_5924_3', 'SRR6031648.Contig_11953_83.802_length_5935_3', 'SRR6833958.Contig_36829_28.5413_length_5784_3', 'SRR806508.Contig_22923_17.5662_length_5787_3', 'SRR806508.Contig_4561_28.5866_length_5893_3', 'SRR806550.Contig_15712_2565.35_length_5987_3'),
            Sinai1 = c('HQ871931.2_2','KY465697.1_2','KY465698.1_2','KY465699.1_2','KY465700.1_2','KY465701.1_2','KY465702.1_2','KY465703.1_2','KY465704.1_2','KY465705.1_2','LR596015.1_2','NC_035466.1_2'),
            Sinai2 = c('HQ888865.2_2','KY465706.1_2','KY465707.1_2','KY465708.1_2','KY465709.1_2','KY465710.1_2','KY465711.1_2','KY465712.1_2','KY465713.1_2','LR655824.1_2','NC_035467.1_2'),
            Sinai = c('KM886902.1_2','KM886903.1_2','KM886904.1_2','KM886905.1_2','KX883223.1_2','KY465714.1_2','KY465715.1_2','KY465716.1_1','KY465717.1_2','KY465719.1_1','KY465720.1_2','MG918125.1_2','NC_032433.1_2'),
            SinaiTO = c('KY354241.1_2'),
            SinaiNE = c('KY354242.1_2','NC_035113.1_2'),
            SinaiSA1 = c('KY354243.1_2','NC_035111.1_2'),
            SinaiSA2 = c('KY354244.1_2', 'NC_035112.1_2'),
            Sinai3 = c('MH267699.1_2','MH267700.1_2'))

cols <- c("0" ="#7f7f7f", "NODE" = "#ff7f0e","SRA" = "#1f77b4","Sinai1" = "#2ca02c",
          "Sinai2" = "#2ca02c","Sinai" = "#2ca02c","SinaiTO" = "#2ca02c",
          "SinaiNE" = "#2ca02c","SinaiSA1" = "#2ca02c","SinaiSA2" = "#2ca02c",
          "Sinai3" = "#2ca02c")

# SinaiS-AA Plot ----------------------------------------------------------
sinais@phylo <- midpoint.root(sinais@phylo)
sinais <- groupOTU(sinais, cls)
sinaistree <- ggtree(sinais, aes(color=group), size=1) +
  #geom_nodelab(aes(label=round(as.numeric(posterior), 2)),alpha=0.5,color='black', size=2, nudge_x=0.01) +
  geom_nodepoint(aes(subset = prob > 0.8), color='black',size=2) + 
  geom_tiplab() + 
  #theme(legend.position = c(0.1,0.9), 
  #      legend.title = element_blank(), # no title
  #      legend.key = element_blank()) +
  xlim(0,0.5) + 
  geom_treescale() + 
  scale_colour_manual(values = cols)
sinaistree
ggsave("treePlots/sinais.svg",sinaistree, device = "svg", dpi=300)
ggsave("treePlots/sinais.pdf",sinaistree, device = "pdf", dpi=300)


# Toti --------------------------------------------------------------------

toti <- read.mrbayes("data/cons_trees/toti.nex.con.tre")


# Toti Colors -------------------------------------------------------------

cls <- list(NODE = c('BP23_NODE_31_length_5100_cov_72_148022_1_',
                     'BeeP_34_2013_NODE_9_length_5861_cov_32_563451_2_'),
            SRA = c('SRR1503019.Contig_22032_542.914_length_5984_1_',
                    'SRR6456322.Contig_9844_124.905_length_7917_1_'),
            victorivirus = c('NC_001963.1_2_',
                             'NC_001964.1_2_',
                             'NC_003607.1_2_',
                             'NC_003876.1_2_',
                             'NC_005074.1_2_',
                             'NC_006367.1_3_',
                             'NC_007523.1_2_',
                             'NC_010246.1_3_',
                             'NC_014823.1_2_',
                             'NC_020997.1_2_',
                             'NC_021565.1_2_',
                             'NC_023547.1_3_',
                             'NC_024151.1_2_',
                             'NC_025366.1_2_',
                             'NC_026140.1_2_',
                             'NC_027209.1_3_',
                             'NC_028477.1_2_',
                             'NC_030224.1_2_',
                             'NC_030392.1_2_',
                             'NC_030867.1_2_',
                             'NC_038928.1_2_',
                             'NC_038929.1_2_',
                             'NC_038930.1_2_',
                             'NC_040653.1_3_',
                             'NC_040793.1_2_'),
            toti = c('NC_009224.1_2_'),
            unclas = c('NC_025218.1_2_',
                       'NC_028948.1_2_',
                       'NC_029989.1_2_',
                       'NC_032424.1_1_',
                       'NC_032806.1_2_',
                       'NC_032819.1.1_',
                       'NC_032851.1_1_',
                       'NC_032931.1.1_',
                       'NC_032948.1_1_',
                       'NC_040530.1_2_'))

cols <- c("0"="#7f7f7f","NODE" = "#ff7f0e","SRA" = "#1f77b4","victorivirus" = "#2ca02c","toti" = "#2ca02c","unclas" = "#7f7f7f")



# Toti Plot ---------------------------------------------------------------
toti@phylo <- midpoint.root(toti@phylo)
toti <- groupOTU(toti, cls)
totitree <- ggtree(toti, aes(color=group), size=1) +
  #geom_nodelab(aes(label=round(as.numeric(posterior), 2)),alpha=0.5,color='black', size=2, nudge_x=0.01) +
  geom_nodepoint(aes(subset = prob > 0.8), color='black',size=2) + 
  geom_tiplab() + 
  #theme(legend.position = c(0.1,0.9), 
  #      legend.title = element_blank(), # no title
  #      legend.key = element_blank()) +
  xlim(0,8) + 
  geom_treescale() + 
  scale_colour_manual(values = cols)
totitree
ggsave("treePlots/toti.svg",totitree, device = "svg", dpi=300)
ggsave("treePlots/toti.pdf",totitree, device = "pdf", dpi=300)



# Tymo --------------------------------------------------------------------

tymo <- read.mrbayes("data/cons_trees/tymo.nex.con.tre")


# Tymo Colors -------------------------------------------------------------
cls <- list(NODE = c('BeeP_37_2013_NODE_30_length_5285_cov_819_119432_2_',
                     'BeeP_43_2013_NODE_1_length_6265_cov_122_817873_1_',
                     'BeeP_49_2013_NODE_19_length_8271_cov_90_694044_4_',
                     'BeeP_49_2013_NODE_37_length_5188_cov_28_459010_1_'),
            SRA = c('SRR1015503_Contig_4257_2592_36_length_5110_3_',
                    'SRR1015531_Contig_28871_50_2275_length_5084_1_',
                    'SRR1503108_Contig_2059_227_433_length_6823_1_',
                    'SRR5117444_Contig_2210_2_85334_length_5011_1_'),
            tymoviridae = c('NC_001480_1_1_',
                            'NC_001746_1_1_',
                            'NC_001793_1_1_',
                            'NC_002588_1_1_',
                            'NC_002786_1_1_',
                            'NC_003634_1_1_',
                            'NC_006950_1_1_',
                            'NC_007609_1_1_',
                            'NC_009532_1_1_',
                            'NC_015522_1_1_',
                            'NC_020470_1_1_',
                            'NC_020471_1_1_',
                            'NC_021851_1_1_',
                            'NC_027631_1_1_',
                            'NC_029063_1_1_',
                            'NC_031692_1_1_',
                            'NC_034205_1_1_',
                            'NC_038328_1_1_',
                            'NC_040565_1_1_'),
            Beta = c('NC_001948_1_1_',
                     'NC_003462_2_1_',
                     'NC_003877_1_1_',
                     'NC_005343_1_1_',
                     'NC_008020_1_1_',
                     'NC_009087_2_1_',
                     'NC_009383_1_1_',
                     'NC_009892_1_1_',
                     'NC_009991_1_1_',
                     'NC_011525_1_1_',
                     'NC_012038_1_1_',
                     'NC_013527_1_1_',
                     'NC_014821_1_1_',
                     'NC_017859_1_1_',
                     'NC_018175_1_1_',
                     'NC_018714_1_1_',
                     'NC_023892_1_1_',
                     'NC_025388_1_1_',
                     'NC_026616_2_1_',
                     'NC_027527_1_1_',
                     'NC_028868_1_1_',
                     'NC_028975_1_1_',
                     'NC_029085_1_1_',
                     'NC_029086_1_1_',
                     'NC_029088_1_1_',
                     'NC_031089_1_1_',
                     'NC_035203_1_1_',
                     'NC_038325_1_1_',
                     'NC_038966_1_1_',
                     'NC_040643_1_1_'),
            Alpha = c('NC_003400_1_1_',
                      'NC_028649_1_1_'))

cols <- c("NODE" = "#ff7f0e","SRA" = "#1f77b4","tymoviridae" = "#2ca02c","Beta" = "#2ca02c","Alpha" = "#2ca02c")


# Tymo Plot ---------------------------------------------------------------
tymo@phylo <- midpoint.root(tymo@phylo)
tymo <- groupOTU(tymo, cls)
tymotree <- ggtree(tymo, aes(color=group), size=1) +
  #geom_nodelab(aes(label=round(as.numeric(posterior), 2)),alpha=0.5,color='black', size=2, nudge_x=0.01) +
  geom_nodepoint(aes(subset = prob > 0.8), color='black',size=2) + 
  geom_tiplab() + 
  #theme(legend.position = c(0.1,0.9), 
  #      legend.title = element_blank(), # no title
  #      legend.key = element_blank()) +
  xlim(0,4) + 
  geom_treescale() + 
  scale_colour_manual(values = cols)
tymotree
ggsave("treePlots/tymo.svg",tymotree, device = "svg", dpi=300)
ggsave("treePlots/tymo.pdf",tymotree, device = "pdf", dpi=300)



# SinaiS_Reco -------------------------------------------------------------

sinaisReco <- read.mrbayes("data/cons_trees/sinais-reco.nex.con.tre")


# sinaiS_Reco Colors ------------------------------------------------------
cls <- list(NODE = c('BP11_NODE_2_length_5933_cov_8664_753785_3', 
                     'BP35_NODE_8_length_6159_cov_3073_471514_2',
                     'BeeP_34_2013_NODE_11_length_5700_cov_81_138894_2',
                     'BeeP_34_2013_NODE_8_length_5876_cov_117_977410_2'),
            SRA = c('SRR1239309.Contig_10906_56.5422_length_5835_2', 'SRR1239309.Contig_3402_33.8366_length_5852_2',
                    'SRR1239310.Contig_18500_86.3069_length_5976_2', 'SRR3927501.Contig_20_4621.33_length_5753_2', 'SRR5109829.Contig_5052_19.3642_length_5832_2',
                    'SRR5117449.Contig_4792_738.395_length_5543_2', 'SRR6031640.Contig_16980_3187.1', 'SRR6031648.Contig_11953_83.802_length_5935_2',
                    'SRR6833958.Contig_36829_28.5413_length_5784_2', 'SRR806508.Contig_22923_17.5662_length_5787_2', 'SRR806508.Contig_45.18.5866_length_5893_2', 'SRR806550.Contig_15712_2565.35_length_5987_2'),
            Sinai1 = c('HQ871931.2','KY465697.1','KY465698.1','KY465699.1','KY465700.1','KY465701.1','KY465702.1','KY465703.1','KY465704.1','KY465705.1','LR596015.1','NC_035466.1'),
            Sinai2 = c('HQ888865.2','KY465706.1','KY465707.1','KY465708.1','KY465709.1','KY465710.1','KY465711.1','KY465712.1','KY465713.1','LR655824.1','NC_035467.1'),
            Sinai = c('KM886902.1','KM886903.1','KM886904.1','KM886905.1','KX883223.1','KY465714.1','KY465715.1','KY465716.1_1','KY465717.1','KY465719.1_1','KY465720.1','MG918125.1','NC_032433.1'),
            SinaiTO = c('KY354241.1'),
            SinaiNE = c('KY354242.1','NC_035113.1'),
            SinaiSA1 = c('KY354243.1','NC_035111.1'),
            SinaiSA2 = c('KY354244.1', 'NC_035112.1'),
            Sinai3 = c('MH267699.1','MH267700.1'))

cols <- c("0" ="#7f7f7f", "NODE" = "#ff7f0e","SRA" = "#1f77b4","Sinai1" = "#2ca02c",
          "Sinai2" = "#2ca02c","Sinai" = "#2ca02c","SinaiTO" = "#2ca02c",
          "SinaiNE" = "#2ca02c","SinaiSA1" = "#2ca02c","SinaiSA2" = "#2ca02c",
          "Sinai3" = "#2ca02c")




# sinaiS-Reco Plot ------------------------------------------------------
sinaisReco@phylo <- midpoint.root(sinaisReco@phylo)
sinaisReco <- groupOTU(sinaisReco, cls)
sinaisRecotree <- ggtree(sinaisReco, aes(color=group), size=1) +
  #geom_nodelab(aes(label=round(as.numeric(posterior), 2)),alpha=0.5,color='black', size=2, nudge_x=0.01) +
  geom_nodepoint(aes(subset = prob > 0.8), color='black',size=2) + 
  geom_tiplab() + 
  #theme(legend.position = c(0.1,0.9), 
  #      legend.title = element_blank(), # no title
  #      legend.key = element_blank()) +
  xlim(0,2) + 
  geom_treescale() + 
  scale_colour_manual(values = cols)
sinaisRecotree
ggsave("treePlots/sinaisReco.svg",sinaisRecotree, device = "svg", dpi=300)
ggsave("treePlots/sinaisReco.pdf",sinaisRecotree, device = "pdf", dpi=300)

# Picorna -----------------------------------------------------------------

picorna <- read.mrbayes("data/cons_trees/picorna.nex.con.tre")


# Picorna Colors ----------------------------------------------------------
#I'm aware this list is too long. However Since I had to rerun trees (putting some stricter inclusion criteria), I cannot be bothered to slim it down.
cls <- list(NODE = c('BP25_NODE_4_length_10404_cov_23.1',
                     'BP36_NODE_2_length_9548_cov_2100_318023_1',
                     'BeeP_11_2013_NODE_163_length_6119_cov_25_630089_1',
                     'BeeP_11_2013_NODE_89_length_9828_cov_350_101733_3',
                     'BeeP_18_2013_NODE.1',
                     'BeeP_35_2013_NODE_.1',
                     'BeeP_35_2013_NODE_60_length_7079_cov_154_4498.1',
                     'BeeP_37_2013_NODE_19_length_6519_cov_37_551382_1'),
            SRA = c('DRR028891.Contig_13953_871.306_length_9532_2',
                    'DRR029070.Contig_14978_423.052_length_5044_1',
                    'DRR029079.Contig_25205_635.734_length_8400_2',
                    'DRR029088.Contig_20659_300.503_length_8750_1',
                    'DRR029097.Contig_45.1',
                    'DRR029626.Contig_27885_122.1.1',
                    'DRR042109.Contig_26746_1597.54_length_8949_1',
                    'DRR042118.Contig_27043_60.265_length_5744_2',
                    'DRR042121.Contig_4205_38.5737_length_6654_1',
                    'DRR042122.Contig_16826_595.626_length_11172_1',
                    'DRR042169.Contig_19034_73266.8_length_9854_1',
                    'DRR042170.Contig_11.1',
                    'DRR129220.Contig_35_1876.38_length_101.1',
                    'ERR1354112.Contig_47798_38.1082_length_10402_1',
                    'ERR1992770.Contig_8425_1079.4_length_5447_1',
                    'ERR528752.Contig_18762_33212.8_length_10106_1',
                    'ERR528754.Contig_3476_73310.3_length_8795_1',
                    'ERR528754.Contig_5610_8040..1',
                    'ERR968678.Contig_2754_32479.1',
                    'SRR1239302.Contig_22774_27701.9_length_7439_1',
                    'SRR1239305.Contig_6874_4817.18_length_9566_2',
                    'SRR1255009.Contig_29506_763.766_length_7867_1',
                    'SRR1255068.Contig_50.1',
                    'SRR1255260.Contig_29135_35127_length_10137_1',
                    'SRR1284947.Contig_37732_40.3568_length_5869_1',
                    'SRR1380984.Contig_11506_100.887_length_6036_1',
                    'SRR1380984.Contig_325_42.4399_length_8247_1',
                    'SRR1502929.Contig_35875_60.96.1',
                    'SRR1503108.Contig_34254_77.5805_length_8369_1',
                    'SRR1503154.Contig_27032_2475.67_length_8873_1',
                    'SRR1503154.Contig_3770_209.723_length_8994_2',
                    'SRR1565472.Contig_10105_23.72_length_6120_2',
                    'SRR1653580.Contig_5344_438778_length_8759_1',
                    'SRR1662295.Contig_1429_18586.2_length_7346_1',
                    'SRR1790682.Contig_13802_38819.9_length_7418_2',
                    'SRR1803085.Contig_16903_23.9063_length_6082_2',
                    'SRR1812779.Contig_15523_639.454_length_5837_1',
                    'SRR1864696.Contig_16496_10.1506_length_5649_1',
                    'SRR1948236.Contig_94.1',
                    'SRR2032844.Contig_14524_34.0605_length_8745_1',
                    'SRR2032844.Contig_29705_493.535_length_9462_2',
                    'SRR2032857.Contig_75.1',
                    'SRR2034262.Contig_4.1',
                    'SRR2080389.Contig_46465_452.775_length_6083_2',
                    'SRR2080396.Contig_81067_13.6737_length_5174_1',
                    'SRR2146250.Contig_21.1',
                    'SRR2146251.Contig_4574_7735.29_length_10115_1',
                    'SRR2177525.Contig_24394_5355.4_length_108.1',
                    'SRR2177537.Contig_25667_9240.42_length_6674_1',
                    'SRR2396634.Contig_5115_45463.4_length_9536_1',
                    'SRR3156045.Contig_17280_34942.2_length_5069_1',
                    'SRR3156047.Contig_21526_11327.6_length_8432_1',
                    'SRR4013500.Contig_35935_1395.48_length_10118_1',
                    'SRR4013516.Contig_14887_4563.27_length_10117_2',
                    'SRR4045764.Contig_28287_21113.9_length_5642_1',
                    'SRR4045850.Contig_190.1',
                    'SRR4084087.Contig_11614_8927.32_length_9557_2',
                    'SRR4250143.Contig_29674_17113.2_length_10102_1',
                    'SRR4250176.Contig_20214_11769.5_length_7583_1',
                    'SRR5109831.Contig_4302_97.6852_length_9578_1',
                    'SRR5109831.Contig_6219_31.8886_length_5533_1',
                    'SRR5116308.Contig_1706_32956.8_length_8385_3',
                    'SRR5117442.Contig_3275_5744.95_length_8643_1',
                    'SRR5117443.Contig_1594_129.633_length_6488_1',
                    'SRR5117443.Contig_4282_118656_length_6666_1',
                    'SRR5117445.Contig_29.1',
                    'SRR5117445.Contig_5646_105.828_length_60.1',
                    'SRR5117445.Contig_7392_2145.29_length_6380_1',
                    'SRR5117445.Contig_7393_2354.5_length_6379_1',
                    'SRR5117445.Contig_7394_1873..1',
                    'SRR5117445.Contig_7595_253.06_length_7010_1_3',
                    'SRR5117445.Contig_8800_43.8666_length_8985_3',
                    'SRR5117446.Contig_3180_534.627_length_9796_1',
                    'SRR5117446.Contig_5028_1577.23_length_9035_1',
                    'SRR5117446.Contig_5480_169.455_length_8182_1',
                    'SRR5117447.Contig_10204_77730.4_length_9212_2',
                    'SRR5117447.Contig_4947_2739.16_length_88.1',
                    'SRR5117447.Contig_9117_25.6389_length_8167_1',
                    'SRR5117449.Contig_6545_449886_length_7855_2',
                    'SRR5117450.Contig_1017_142.726_length_6550_1',
                    'SRR5117450.Contig_2957_74.6619_length_9162_2',
                    'SRR5136449.Contig_93.1',
                    'SRR5387738.Contig_3705_102404_length_5494_2',
                    'SRR5907694.Contig_18862_127.622_length_6708_1',
                    'SRR5907701.Contig_9257_31.1375_length_8376_1',
                    'SRR6001380.Contig_28689_35.9473_length_8774_1',
                    'SRR6047315.Contig_12488_10784.6_length_5117_1',
                    'SRR6788737.Contig_22243_290.138_length_5574_1',
                    'SRR6788742.Contig_21289_172.807_length_9627_1',
                    'SRR6806695.Contig_18575_113.485_length_6775_1',
                    'SRR6806700.Contig_16879_1139_length_5280_1',
                    'SRR6806702.Contig_8773_62.9543_length_7423_1',
                    'SRR6823683.Contig_17167_2220.97_length_8415_1',
                    'SRR6823685.Contig_1826_2787.67_length_84.1',
                    'SRR6833955.Contig_31686_58007.2_length_5475_1',
                    'SRR6833962.Contig_32592_101504_length_10143_1',
                    'SRR7192242.Contig_33466_34.1313_length_5260_1',
                    'SRR806508.Contig_1676_28.6109_length_8157_1',
                    'SRR806709.Contig_20209_5699.86_length_8808_1',
                    'SRR806709.Contig_26036_19626.1',
                    'SRR807359.Contig_2988_193.1'),
            ifla = c('AB070959.1',
                     'AF092924.1',
                     'AF469603.1',
                     'AJ489744.2_Deformed_Wing_Virus_gene_for_polyprotein',
                     'AY251269.2_Varroa_destructor_virus_1',
                     'AY292384.1',
                     'EU035616.1',
                     'GU109335.1',
                     'GU938761.1',
                     'HM067437.1',
                     'HM067438.1',
                     'HM162356.1',
                     'HQ322114.1',
                     'JF440525.1',
                     'JF440526.1',
                     'JQ390591.1',
                     'JQ390592.1',
                     'JQ413340.1',
                     'JX194121.1',
                     'JX270795.1',
                     'JX270796.1',
                     'JX270797.1',
                     'JX270798.1',
                     'JX270799.1',
                     'JX270800.1',
                     'JX878304.1',
                     'JX878305.1',
                     'KC007374.1',
                     'KC285046.1',
                     'KC786222.1',
                     'KC786223.1',
                     'KC786224.1',
                     'KF500002.1',
                     'KF960044.1',
                     'KJ000692.1',
                     'KJ437447.1',
                     'KJ629183.1',
                     'KJ716805.1',
                     'KJ716806.1',
                     'KJ959613.1',
                     'KJ959614.1',
                     'KM495267.1',
                     'KM884990.1',
                     'KM884991.1',
                     'KM884992.1',
                     'KM884993.1',
                     'KM884994.1',
                     'KM884995.1',
                     'KP296800.1',
                     'KP296801.1',
                     'KP296802.1',
                     'KP296803.1',
                     'KT004425.1',
                     'KU645789.1',
                     'KU847397.1',
                     'KX373900.1',
                     'KX580899.1',
                     'KX663835.1',
                     'KX668139.1',
                     'KX668140.1',
                     'KX668141.1',
                     'KX779454.1',
                     'KX783225.1',
                     'KX786162.1',
                     'KX819276.1',
                     'KY243931.1',
                     'KY273489.1',
                     'KY465671.1',
                     'KY465672.1',
                     'KY465673.1',
                     'KY465674.1',
                     'KY465675.1',
                     'KY465676.1',
                     'KY465677.1',
                     'KY465678.1',
                     'KY465679.1',
                     'KY774627.1',
                     'KY774628.1',
                     'KY887697.1',
                     'KY887698.1',
                     'KY887699.1',
                     'KY909333.1',
                     'MF036686.1',
                     'MF346349.1',
                     'MF623170.1',
                     'MF623172.1',
                     'MF770715.1',
                     'MG545286.1',
                     'MG545287.1',
                     'MH069503.1',
                     'MH069504.1',
                     'MH069505.1',
                     'MH069506.1',
                     'MH069507.1',
                     'MH107056.1',
                     'MH165180.1',
                     'MH267695.1',
                     'MH267696.1',
                     'MH267697.1',
                     'MH267698.1',
                     'MH509439.1',
                     'NC_002066.1',
                     'NC_004830.2_Deformed_wing_virus',
                     'NC_014137.1',
                     'NC_023022.1',
                     'NC_031338.1',
                     'NC_031749.1'),
            como = c('AB295643.1',
                     'AB456531.1',
                     'AF394606.1',
                     'AF394608.1',
                     'AY303786.1',
                     'AY744931.1',
                     'AY744932.1',
                     'D00915.1',
                     'EU450837.1',
                     'EU617326.1',
                     'FJ516745.1',
                     'FJ712026.1',
                     'GQ222381.1',
                     'GQ332372.1',
                     'GQ332373.1',
                     'GQ369526.1',
                     'GQ369527.1',
                     'GQ369528.1',
                     'GQ996948.1',
                     'GQ996951.1',
                     'GQ996952.1',
                     'GQ996953.1',
                     'GU562879.1',
                     'GU810903.1',
                     'GU968732.1',
                     'HE613269.1',
                     'HM032712.1',
                     'JF968120.1',
                     'JN391442.1',
                     'JQ975057.1',
                     'JX513889.1',
                     'JX513894.1',
                     'KC138732.1',
                     'KC900162.1',
                     'KP404602.1',
                     'KU522584.1',
                     'KX011072.1',
                     'KX011073.1',
                     'KX011074.1',
                     'KX011075.1',
                     'KX034840.1',
                     'KX034841.1',
                     'KX034842.1',
                     'KX034843.1',
                     'KX034844.1',
                     'KX034845.1',
                     'KX034846.1',
                     'KX034847.1',
                     'KX034848.1',
                     'KX034849.1',
                     'KX034850.1',
                     'KX034851.1',
                     'KX034852.1',
                     'KX034853.1',
                     'KX034854.1',
                     'KX034855.1',
                     'KX034856.1',
                     'KX034857.1',
                     'KX034858.1',
                     'KX034859.1',
                     'KX034860.1',
                     'KX034861.1',
                     'KX034862.1',
                     'KX034863.1',
                     'KX034864.1',
                     'KX034865.1',
                     'KX034866.1',
                     'KX034867.1',
                     'KX034868.1',
                     'KX034869.1',
                     'KX034870.1',
                     'KX034871.1',
                     'KX034872.1',
                     'KX034873.1',
                     'KX034874.1',
                     'KX034875.1',
                     'KX034876.1',
                     'KX034877.1',
                     'KX034878.1',
                     'KX034879.1',
                     'KX034880.1',
                     'KX034881.1',
                     'KX034882.1',
                     'KX034883.1',
                     'KX034884.1',
                     'KX034885.1',
                     'KX034886.1',
                     'KX034887.1',
                     'KX034888.1',
                     'KX034889.1',
                     'KX034890.1',
                     'KX034891.1',
                     'KX034892.1',
                     'KX034893.1',
                     'KX034894.1',
                     'KX034895.1',
                     'KX034896.1',
                     'KX034897.1',
                     'KX034898.1',
                     'KX034899.1',
                     'KX034900.1',
                     'KX034901.1',
                     'KX034902.1',
                     'KX034903.1',
                     'KX034904.1',
                     'KX034905.1',
                     'KY622124.1',
                     'KY701258.1',
                     'MF804979.1',
                     'MH053441.1',
                     'MH383240.1',
                     'MH383242.1',
                     'MH802014.1',
                     'MH802016.1',
                     'MH802018.1',
                     'MH802025.1',
                     'MH802027.1',
                     'MH802030.1',
                     'MH802032.1',
                     'NC_003496.1',
                     'NC_003741.1',
                     'NC_006057.1',
                     'NC_010709.1',
                     'NC_013218.1',
                     'NC_017939.1',
                     'NC_022004.1',
                     'NC_028139.1',
                     'U70866.1',
                     'X64886.1'),
            dicistro = c('AF150629.1',
                         'AF536531.1',
                         'AY275710.1',
                         'EF219380.1',
                         'EU218534.1',
                         'EU224279.1',
                         'EU224280.1',
                         'EU436423.1',
                         'EU436455.1',
                         'EU436456.1',
                         'HQ897161.1',
                         'JQ320375.1',
                         'JX045857.1',
                         'JX045858.1',
                         'JX480861.1',
                         'KC690268.1',
                         'KC690269.1',
                         'KC690270.1',
                         'KF500001.1',
                         'KF956377.1',
                         'KJ817182.1',
                         'KR021407.1',
                         'KX158871.1',
                         'KX421583.1',
                         'KX610809.1',
                         'KX830963.1',
                         'KX883690.1',
                         'KX883929.1',
                         'KX883977.1',
                         'KX884276.1',
                         'KY243933.1',
                         'KY465689.1',
                         'KY465690.1',
                         'KY465691.1',
                         'KY465692.1',
                         'KY465693.1',
                         'KY465694.1',
                         'KY465695.1',
                         'KY465696.1',
                         'LN907586.1',
                         'LN907587.1',
                         'LN907588.1',
                         'LN907589.1',
                         'MF189971.1',
                         'MF458892.1',
                         'MF458893.1',
                         'MF535297.1',
                         'MF795134.1',
                         'MF795135.1',
                         'MG599488.1',
                         'MH188004.1',
                         'NC_002548.1',
                         'NC_004365.1',
                         'NC_004807.1',
                         'NC_023021.1'),
            polycipi = c('EF428566.1',
                         'KX883910.1',
                         'MF041808.1',
                         'MF041809.1',
                         'MF041810.1',
                         'MG676340.1',
                         'MH213247.1',
                         'NC_032978.1',
                         'NC_035450.1',
                         'NC_035455.1',
                         'NC_035457.1',
                         'NC_039236.1'),
            marna = c('KF478836.2_Marine_RNA_virus_SF_3_polyprotein_gene',
                      'NC_043519.1'),
            picornavir = c('MN167485.1'),
            unclas = c('DQ321720.2_Nora_virus',
                       'GQ257737.1',
                       'JX220408.1',
                       'KF242510.1',
                       'KF242511.1',
                       'KP970076.1',
                       'KP970077.1',
                       'KP970078.1',
                       'KP970079.1',
                       'KP970080.1',
                       'KP970081.1',
                       'KP970082.1',
                       'KP970083.1',
                       'KP970084.1',
                       'KP970085.1',
                       'KP970086.1',
                       'KP970087.1',
                       'KP970088.1',
                       'KP970089.1',
                       'KP970090.1',
                       'KP970091.1',
                       'KP970092.1',
                       'KP970093.1',
                       'KP970094.1',
                       'KP970095.1',
                       'KP970096.1',
                       'KP970097.1',
                       'KP970098.1',
                       'KP970099.1',
                       'KP970100.1',
                       'KP970101.1',
                       'KP970102.1',
                       'KP970103.1',
                       'KP970104.1',
                       'KP970105.1',
                       'KP970106.1',
                       'KX883294.1',
                       'KX883645.1',
                       'KX883659.1',
                       'KX883694.1',
                       'KX883930.1',
                       'KX883975.1',
                       'KX884537.1',
                       'KY354240.1',
                       'MF287666.1',
                       'MF287668.1',
                       'MF593921.1',
                       'MF893254.1',
                       'MG995694.1',
                       'MG995696.1',
                       'MG995697.1',
                       'MG995699.1',
                       'MG995707.1',
                       'MG995709.1',
                       'MG995720.1',
                       'MG995723.1',
                       'MG995724.1',
                       'MG995731.1',
                       'MH384279.1',
                       'MH719200.1',
                       'MH899120.1',
                       'MK533158.1',
                       'MK643150.1',
                       'NC_007919.3_Nora_virus',
                       'NC_024487.1',
                       'NC_024488.1',
                       'NC_032904.1',
                       'NC_033094.1',
                       'NC_033455.1'))

cols <- c("NODE" = "#ff7f0e",
          "SRA" = "#1f77b4",
          "ifla" = "#2ca02c",
          "como" = "#2ca02c",
          "dicistro" = "#2ca02c",
          "polycipi" = "#2ca02c",
          "marna"="#2ca02c",
          "picornavir"="#2ca02c",
          "0" = "red",
          "unclas" = "#7f7f7f")
cols2 <- c("NODE" = "#ff7f0e",
           "SRA" = "#1f77b4",
           "ifla" = "red",
           "como" = "purple",
           "dicistro" = "blue",
           "polycipi" = "black",
           "marna"="darkgrey",
           "picornavir"="lightblue",
           "0" = "red",
           "unclas" = "#7f7f7f")
# Picorna Plot ------------------------------------------------------------
picorna@phylo <- midpoint.root(picorna@phylo)
picorna <- groupOTU(picorna, cls)
picornatree <- ggtree(picorna, aes(color=group), size=1) +
  #geom_nodelab(aes(label=round(as.numeric(posterior), 2)),alpha=0.5,color='black', size=2, nudge_x=0.01) +
  geom_nodepoint(aes(subset = prob > 0.8), color='black',size=2) + 
  geom_tiplab() + 
  #theme(legend.position = c(0.1,0.9), 
  #      legend.title = element_blank(), # no title
  #      legend.key = element_blank()) +
  xlim(0,3) + 
  geom_treescale() + 
  scale_colour_manual(values = cols)
picornatree
ggsave("treePlots/picorna.svg",picornatree, device = "svg", dpi=300)
ggsave("treePlots/picorna.pdf",picornatree, device = "pdf", dpi=300)


# Rhabdo ------------------------------------------------------------------
rhabdo <- read.mrbayes("data/cons_trees/rhabdo.nex.con.tre")

# Rhabdo Colors -----------------------------------------------------------
cls <- list(NODE = c('BeeP_34_2013_NODE_2_length_13379_cov_90_712825_1',
                     'BeeP_38_2013_NODE_4_length_14545_cov_165_264238_1'),
            SRA = c('DRR028884.Contig_7883_22.9921_length_11588_6',
                    'DRR029859.Contig_7759_128.983_length_12223_5',
                    'SRR1255153.Contig_26024_304.72_length_12652_7',
                    'SRR1503154.Contig_19807_185.1',
                    'SRR2105774.Contig_25932_42.3',
                    'SRR2649096.Contig_3656_426.3',
                    'SRR4013517.Contig_19821_37.8069_length_10983_2',
                    'SRR5868360.Contig_3779_58.7904_length_10073_5',
                    'SRR6819909.Contig_3811_325.1',
                    'SRR7192237.Contig_7933_213.1',
                    'SRR974922.Contig_11618_267.764_length_12229_5'),
            rhabdo = c('AB009601.1',
                       'AB011257.1',
                       'AB075039.1',
                       'AB244418.1',
                       'AB362483.1',
                       'AB516283.1',
                       'AB516441.1',
                       'AB517660.1',
                       'AB735628.2',
                       'AB981663.1',
                       'AB981664.1',
                       'AF418014.1',
                       'AF499686.2',
                       'AJ746199.1',
                       'AJ810083.1',
                       'AJ810084.2',
                       'AJ867584.2',
                       'AM689309.3',
                       'AY618418.1',
                       'AY674964.1',
                       'DQ186554.1',
                       'EF157976.1',
                       'EF564174.1',
                       'EF614260.1',
                       'EF614261.1',
                       'EF687738.1',
                       'EU259198.1',
                       'EU293108.1',
                       'EU293109.1',
                       'EU293110.1',
                       'EU293111.1',
                       'EU293112.1',
                       'EU293119.1',
                       'EU293120.1',
                       'EU293121.1',
                       'EU373657.1',
                       'EU623444.1',
                       'EU626551.1',
                       'EU626552.1',
                       'EU886633.1',
                       'FJ712194.1',
                       'FJ712195.1',
                       'FJ866835.1',
                       'FJ866836.1',
                       'FJ959397.1',
                       'FJ985748.1',
                       'FJ985749.1',
                       'FR751552.4',
                       'GQ410980.1',
                       'GU170201.1',
                       'GU170202.1',
                       'GU190711.1',
                       'GU212856.1',
                       'GU212857.1',
                       'GU212858.1',
                       'GU345746.1',
                       'GU345747.1',
                       'GU345748.1',
                       'GU734660.1',
                       'HM627182.1',
                       'HM627187.1',
                       'HM849039.1',
                       'HQ317918.1',
                       'JF911700.1',
                       'JN710440.1',
                       'JN786877.1',
                       'JN786878.1',
                       'JN986749.1',
                       'JQ423952.1',
                       'JQ595336.1',
                       'JQ595337.1',
                       'JQ595339.1',
                       'JQ595340.1',
                       'JQ595342.1',
                       'JQ595343.1',
                       'JQ595347.1',
                       'JQ595348.1',
                       'JQ595349.1',
                       'JQ595353.1',
                       'JQ595354.1',
                       'JQ595355.1',
                       'JQ595356.1',
                       'JQ595357.1',
                       'JQ595358.1',
                       'JQ595359.1',
                       'JQ595360.1',
                       'JQ595362.1',
                       'JQ595363.1',
                       'JQ595364.1',
                       'JQ595365.1',
                       'JQ595366.1',
                       'JQ595367.1',
                       'JQ595368.1',
                       'JQ595369.1',
                       'JQ595370.1',
                       'JQ595371.1',
                       'JQ595372.1',
                       'JQ595373.1',
                       'JQ595375.1',
                       'JQ595376.1',
                       'JQ595377.1',
                       'JQ595378.1',
                       'JQ595379.1',
                       'JQ685943.1',
                       'JQ685975.1',
                       'JQ730682.1',
                       'JQ944705.1',
                       'JQ970481.1',
                       'JQ970482.1',
                       'JQ970483.1',
                       'JQ970486.1',
                       'JX129232.1',
                       'JX129233.1',
                       'JX403908.1',
                       'JX403909.1',
                       'JX403910.1',
                       'JX403911.1',
                       'JX403912.1',
                       'JX403913.1',
                       'JX403914.1',
                       'JX403915.1',
                       'JX403916.1',
                       'JX403918.1',
                       'JX403919.1',
                       'JX403920.1',
                       'JX403922.1',
                       'JX403923.1',
                       'JX403925.1',
                       'JX403929.1',
                       'JX403930.1',
                       'JX403931.1',
                       'JX403932.1',
                       'JX403934.1',
                       'JX442979.1',
                       'JX569193.2',
                       'JX901139.1',
                       'K02378.1',
                       'KC193267.1',
                       'KC252633.1',
                       'KC252634.1',
                       'KC595280.1',
                       'KC595281.1',
                       'KC595282.1',
                       'KC595283.1',
                       'KC602379.1',
                       'KC660078.1',
                       'KC905081.1',
                       'KF155000.1',
                       'KF155003.1',
                       'KF209276.1',
                       'KF410949.2',
                       'KF468772.1',
                       'KF468773.1',
                       'KF468774.1',
                       'KF468775.1',
                       'KF935252.1',
                       'KF947078.1',
                       'KJ004416.1',
                       'KJ082087.1',
                       'KJ466147.1',
                       'KJ564280.1',
                       'KJ685548.1',
                       'KM016899.1',
                       'KM204983.1',
                       'KM204990.1',
                       'KM205003.1',
                       'KM205010.1',
                       'KM205012.1',
                       'KM205018.1',
                       'KM594025.1',
                       'KM594039.1',
                       'KM817634.1',
                       'KM817636.1',
                       'KM817642.1',
                       'KM817643.1',
                       'KM817645.1',
                       'KM817647.1',
                       'KM817649.1',
                       'KM817651.1',
                       'KM817659.1',
                       'KM823531.1',
                       'KP241939.1',
                       'KP735609.1',
                       'KP997032.1',
                       'KR230089.1',
                       'KR230090.1',
                       'KR534252.2',
                       'KR822813.1',
                       'KR822817.1',
                       'KR822823.1',
                       'KR822824.1',
                       'KR906741.1',
                       'KR906746.1',
                       'KR906747.1',
                       'KR906753.1',
                       'KR906757.1',
                       'KR906779.1',
                       'KR906790.1',
                       'KT160285.1',
                       'KT160286.1',
                       'KT160287.1',
                       'KT336435.1',
                       'KT336436.1',
                       'KT336437.1',
                       'KT868953.1',
                       'KT868954.1',
                       'KT868955.1',
                       'KT868956.1',
                       'KU754523.1',
                       'KU946961.1',
                       'KX148102.1',
                       'KX148103.1',
                       'KX148108.1',
                       'KX148110.1',
                       'KX148111.1',
                       'KX148112.1',
                       'KX148145.1',
                       'KX148177.1',
                       'KX148178.1',
                       'KX148179.1',
                       'KX148180.1',
                       'KX148203.1',
                       'KX148207.1',
                       'KX148209.1',
                       'KX148210.1',
                       'KX148211.1',
                       'KX148217.1',
                       'KX148218.1',
                       'KX148219.1',
                       'KX148220.1',
                       'KX148221.1',
                       'KX148222.1',
                       'KX148228.1',
                       'KX148245.1',
                       'KX148246.1',
                       'KX148247.1',
                       'KX148248.1',
                       'KX148253.1',
                       'KX148255.1',
                       'KX148256.1',
                       'KX148257.1',
                       'KX148258.1',
                       'KX148259.1',
                       'KX148260.1',
                       'KX148261.1',
                       'KX148262.1',
                       'KX148263.1',
                       'KX148267.1',
                       'KX636164.1',
                       'KX708503.1',
                       'KX708504.1',
                       'KX852388.1',
                       'KX982179.1',
                       'KX982180.1',
                       'KX982181.1',
                       'KY026415.1',
                       'KY075646.1',
                       'KY210245.1',
                       'KY210252.1',
                       'KY210263.1',
                       'KY210309.1',
                       'KY210311.1',
                       'KY354230.1',
                       'KY354231.1',
                       'KY354232.1',
                       'KY354233.1',
                       'KY354234.1',
                       'KY549567.1',
                       'KY688151.1',
                       'KY700686.1',
                       'KY706238.1',
                       'KY751405.1',
                       'KY780299.1',
                       'KY810772.1',
                       'KY859866.1',
                       'KY860593.1',
                       'L32603.1',
                       'LC222630.1',
                       'LC270812.1',
                       'LM645016.1',
                       'LN680656.1',
                       'LN849915.1',
                       'LT839608.1',
                       'LT839609.1',
                       'LT839610.1',
                       'LT839611.1',
                       'LT839612.1',
                       'LT839613.1',
                       'LT839614.1',
                       'LT839615.1',
                       'LT909527.1',
                       'LT909530.1',
                       'LT909537.1',
                       'LT909543.1',
                       'LT909544.1',
                       'LT909549.1',
                       'M87829.1',
                       'MF079256.1',
                       'MF102281.1',
                       'MF114349.1',
                       'MF114350.1',
                       'MF114351.1',
                       'MF187801.1',
                       'MF187802.1',
                       'MF187803.1',
                       'MF187804.1',
                       'MF187805.1',
                       'MF187806.1',
                       'MF187807.1',
                       'MF187808.1',
                       'MF187809.1',
                       'MF187810.1',
                       'MF187811.1',
                       'MF187812.1',
                       'MF187813.1',
                       'MF187814.1',
                       'MF187815.1',
                       'MF187816.1',
                       'MF187817.1',
                       'MF187818.1',
                       'MF187819.1',
                       'MF187820.1',
                       'MF187821.1',
                       'MF187822.1',
                       'MF187823.1',
                       'MF187824.1',
                       'MF187825.1',
                       'MF187826.1',
                       'MF187827.1',
                       'MF187828.1',
                       'MF187829.1',
                       'MF187830.1',
                       'MF187831.1',
                       'MF187832.1',
                       'MF187833.1',
                       'MF187834.1',
                       'MF187835.1',
                       'MF187836.1',
                       'MF187837.1',
                       'MF187838.1',
                       'MF187839.1',
                       'MF187840.1',
                       'MF187841.1',
                       'MF187842.1',
                       'MF187843.1',
                       'MF187844.1',
                       'MF187845.1',
                       'MF187846.1',
                       'MF187847.1',
                       'MF187848.1',
                       'MF187849.1',
                       'MF187850.1',
                       'MF187851.1',
                       'MF187852.1',
                       'MF187853.1',
                       'MF187854.1',
                       'MF187855.1',
                       'MF187856.1',
                       'MF187857.1',
                       'MF187858.1',
                       'MF187859.1',
                       'MF187860.1',
                       'MF187861.1',
                       'MF187862.1',
                       'MF187863.1',
                       'MF187864.1',
                       'MF187865.1',
                       'MF187866.1',
                       'MF187867.1',
                       'MF187868.1',
                       'MF187869.1',
                       'MF187870.1',
                       'MF187871.1',
                       'MF187872.1',
                       'MF187873.1',
                       'MF187874.1',
                       'MF187875.1',
                       'MF187876.1',
                       'MF187877.1',
                       'MF187878.1',
                       'MF187879.1',
                       'MF187880.1',
                       'MF197741.1',
                       'MF197743.1',
                       'MF197744.1',
                       'MF197745.1',
                       'MF360790.1',
                       'MF360791.1',
                       'MF536978.1',
                       'MF536979.1',
                       'MF543022.1',
                       'MF918568.1',
                       'MF962659.1',
                       'MF975531.1',
                       'MG201920.1',
                       'MG201922.1',
                       'MG385079.1',
                       'MG458308.1',
                       'MG458318.1',
                       'MG552608.1',
                       'MG562529.1',
                       'MG562531.1',
                       'MG562532.1',
                       'MG562536.1',
                       'MG562537.1',
                       'MG562538.1',
                       'MG562539.1',
                       'MG562544.1',
                       'MG562546.1',
                       'MG562547.1',
                       'MG562599.1',
                       'MG562607.1',
                       'MG600015.1',
                       'MG604920.1',
                       'MG717932.1',
                       'MG948563.1',
                       'MG983789.1',
                       'MG983791.1',
                       'MH102387.1',
                       'MH129615.1',
                       'MH129616.1',
                       'MH213246.1',
                       'MH267691.1',
                       'MH267692.1',
                       'MH323437.1',
                       'MH349091.1',
                       'MH384277.1',
                       'MH384306.1',
                       'MH595622.1',
                       'MH620817.1',
                       'MH688523.1',
                       'MH707450.1',
                       'MH778545.1',
                       'MH926029.1',
                       'MH926030.1',
                       'MH926031.1',
                       'MK063878.2',
                       'MK063879.2',
                       'MK112501.2',
                       'MK159261.1',
                       'MK240091.1',
                       'MK257717.1',
                       'MK522805.1',
                       'MK522807.1',
                       'MK540667.1',
                       'MK540697.1',
                       'MK540698.1',
                       'MK540706.1',
                       'MK540707.1',
                       'MK540709.1',
                       'MK540712.1',
                       'MK540713.1',
                       'MK540714.1',
                       'MK540717.1',
                       'MK540720.1',
                       'MK540721.1',
                       'MK540724.1',
                       'MK540733.1',
                       'MK540735.1',
                       'MK540740.1',
                       'MK540742.1',
                       'MK540747.1',
                       'MK540752.1',
                       'MK540762.1',
                       'MK540767.1',
                       'MK540769.1',
                       'MK540771.1',
                       'MK540773.1',
                       'MK540774.1',
                       'MK540782.1',
                       'MK540785.1',
                       'MK540788.1',
                       'MK540793.1',
                       'MK540890.1',
                       'MK540903.1',
                       'MK567666.1',
                       'MK577649.1',
                       'MK760677.1',
                       'MK760709.1',
                       'MK760727.1',
                       'MK760728.1',
                       'MK760739.1',
                       'MK760764.1',
                       'MK828539.1',
                       'MK948541.1',
                       'MN013386.1',
                       'MN013387.1',
                       'MN013388.1',
                       'MN013389.1',
                       'MN013390.1',
                       'MN013391.1',
                       'MN013392.1',
                       'MN013393.1',
                       'NC_001542.1',
                       'NC_001615.3',
                       'NC_003243.1',
                       'NC_003746.1',
                       'NC_005975.1',
                       'NC_006429.1',
                       'NC_006942.1',
                       'NC_007642.1',
                       'NC_008514.1',
                       'NC_009527.1',
                       'NC_009528.2',
                       'NC_009609.1',
                       'NC_011532.1',
                       'NC_011558.1',
                       'NC_016136.1',
                       'NC_018381.2',
                       'NC_020804.1',
                       'NC_020805.1',
                       'NC_020807.1',
                       'NC_020808.1',
                       'NC_020810.1',
                       'NC_022580.1',
                       'NC_022755.1',
                       'NC_024473.1',
                       'NC_025251.1',
                       'NC_025253.1',
                       'NC_025359.1',
                       'NC_025365.1',
                       'NC_025378.1',
                       'NC_025382.1',
                       'NC_025385.1',
                       'NC_025389.1',
                       'NC_025391.1',
                       'NC_025397.1',
                       'NC_025399.1',
                       'NC_025405.1',
                       'NC_025408.1',
                       'NC_028230.1',
                       'NC_028231.1',
                       'NC_028232.1',
                       'NC_028234.1',
                       'NC_028237.2',
                       'NC_028241.1',
                       'NC_028255.1',
                       'NC_030451.1',
                       'NC_031079.1',
                       'NC_031083.1',
                       'NC_031093.1',
                       'NC_031227.1',
                       'NC_031236.1',
                       'NC_031272.1',
                       'NC_031273.1',
                       'NC_031276.1',
                       'NC_031283.1',
                       'NC_031301.1',
                       'NC_031303.1',
                       'NC_031691.1',
                       'NC_031955.1',
                       'NC_031957.1',
                       'NC_031988.1',
                       'NC_033705.1',
                       'NC_034240.1',
                       'NC_034529.1',
                       'NC_034533.1',
                       'NC_034534.1',
                       'NC_034535.1',
                       'NC_034545.1',
                       'NC_034546.1',
                       'NC_034548.1',
                       'NC_034549.1',
                       'NC_034550.1',
                       'NC_036390.1',
                       'NC_038236.1',
                       'NC_038278.1',
                       'NC_038280.1',
                       'NC_038281.1',
                       'NC_038282.1',
                       'NC_038283.1',
                       'NC_038285.1',
                       'NC_038287.1',
                       'NC_038755.1',
                       'NC_039020.1',
                       'NC_039021.1',
                       'NC_039206.1',
                       'NC_040602.1',
                       'NC_043649.1'),
            nyami = c('FJ554525.1',
                      'FJ554526.1',
                      'HM849038.1',
                      'KF530058.1',
                      'KM817644.1',
                      'KX257488.1',
                      'KX884406.1',
                      'KX884407.1',
                      'KX884408.1',
                      'MG550265.1',
                      'MG550266.1',
                      'MG550267.1',
                      'MH477287.1',
                      'MK971153.1',
                      'NC_012702.1',
                      'NC_012703.1',
                      'NC_024376.1',
                      'NC_024702.1',
                      'NC_031275.1',
                      'NC_032543.1',
                      'NC_032544.1',
                      'NC_043485.1',
                      'NC_043486.1'),
            lispi = c('KM817632.1',
                      'NC_031259.1'),
            xinmo = c('KM817638.1',
                      'NC_043484.1'),
            mymona = c('KT598228.1',
                       'LC466007.1',
                       'MH648611.1'),
            narna = c('MN034260.1',
                      'MN035123.1',
                      'MN035214.1'),
            polycipi = c('MH477288.1'),
            arto = c('KX884420.1',
                     'KX884421.1',
                     'KX884446.1',
                     'NC_038269.1'),
            unclas = c('KM817631.1',
                       'KM817633.1',
                       'KM817637.1',
                       'KM817639.1',
                       'KM817641.1',
                       'KM817655.1',
                       'KX580901.1',
                       'KX884405.1',
                       'KX884410.1',
                       'KX884411.1',
                       'KX884412.1',
                       'KX884413.1',
                       'KX884414.1',
                       'KX884417.1',
                       'KX884418.1',
                       'KX884422.1',
                       'KX884440.1',
                       'KX884441.1',
                       'KX884443.1',
                       'KX884447.1',
                       'KX884448.1',
                       'KX884450.1',
                       'KX884456.1',
                       'KX884457.1',
                       'LN713933.1',
                       'MF287670.1',
                       'MF444285.1',
                       'MG489864.1',
                       'MK026565.1',
                       'MK026568.1',
                       'MK584853.1',
                       'MK584858.1',
                       'NC_031088.1',
                       'NC_031217.1',
                       'NC_031270.1',
                       'NC_031304.1',
                       'NC_032430.1',
                       'NC_032432.1',
                       'NC_032541.1',
                       'NC_032555.1',
                       'NC_032558.1',
                       'NC_032739.1',
                       'NC_032781.1',
                       'NC_032793.1',
                       'NC_032849.1',
                       'NC_032929.1',
                       'NC_032944.1',
                       'NC_032971.1',
                       'NC_033070.1',
                       'NC_033182.1',
                       'NC_033261.1',
                       'NC_033267.1',
                       'NC_033436.1',
                       'NC_033703.1',
                       'NC_035133.1'))
cols <- c("NODE" = "#ff7f0e",
          "SRA" = "#1f77b4",
          "rhabdo"="#2ca02c",
          "nyami"="#2ca02c",
          "lispi"="#2ca02c",
          "xinmo"="#2ca02c",
          "mymona"="#2ca02c",
          "narna"="#2ca02c",
          "polycipi" = "#2ca02c",
          "arto" = "#2ca02c",
          "unclas" = "#7f7f7f",
          "0" = "red")

cols2 <- c("NODE" = "#ff7f0e",
           "SRA" = "#1f77b4",
           "rhabdo"="blue",
           "nyami"="red",
           "lispi"="orange",
           "xinmo"="purple",
           "mymona"="green",
           "narna"="black",
           "polycipi" = "orange",
           "arto" = "lightgreen",
           "unclas" = "#7f7f7f",
           "0" = "red")

# Rhabdo Plot -------------------------------------------------------------
rhabdo@phylo <- midpoint.root(rhabdo@phylo)
rhabdo <- groupOTU(rhabdo, cls)
rhabdotree <- ggtree(rhabdo, aes(color=group), size=1) +
  #geom_nodelab(aes(label=round(as.numeric(posterior), 2)),alpha=0.5,color='black', size=2, nudge_x=0.01) +
  geom_nodepoint(aes(subset = prob > 0.8), color='black',size=2) + 
  geom_tiplab() + 
  #theme(legend.position = c(0.1,0.9), 
  #      legend.title = element_blank(), # no title
  #      legend.key = element_blank()) +
  xlim(0,3) + 
  geom_treescale() + 
  scale_colour_manual(values = cols)
rhabdotree
ggsave("treePlots/rhabdo.svg",rhabdotree, device = "svg", dpi=300)
ggsave("treePlots/rhabdo.pdf",rhabdotree, device = "pdf", dpi=300)

