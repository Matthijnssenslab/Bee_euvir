'MK540762.1_Rabies_lyssavirus_isolate_NY.2011.0948O',
'MK540767.1_Rabies_lyssavirus_isolate_NY.2011.1517R',
'MK540769.1_Rabies_lyssavirus_isolate_NY.2011.2074O',
'MK540771.1_Rabies_lyssavirus_isolate_NY.2011.2208R',
'MK540773.1_Rabies_lyssavirus_isolate_NY.2011.2320R',
'MK540774.1_Rabies_lyssavirus_isolate_NY.2011.2342O',
'MK540782.1_Rabies_lyssavirus_isolate_NY.2011.4696S',
'MK540785.1_Rabies_lyssavirus_isolate_NY.2011.5062R',
'MK540788.1_Rabies_lyssavirus_isolate_NY.2011.5446S',
'MK540793.1_Rabies_lyssavirus_isolate_NY.2011.6409S',
'MK540890.1_Rabies_lyssavirus_isolate_ON.1990.9340SSK',
'MK540903.1_Rabies_lyssavirus_isolate_ON.1993.0215RFX',
'MK567666.1_Rabies_lyssavirus_strain_GSQY-Dog-China-2013',
'MK577649.1_Rabies_lyssavirus_strain_GSJC-Sheep-China-2015',
'MK760677.1_Rabies_lyssavirus_isolate_87-395_nucleoprotein',
'MK760709.1_Rabies_lyssavirus_isolate_91-A-57_nucleoprotein',
'MK760727.1_Rabies_lyssavirus_isolate_92-343_nucleoprotein',
'MK760728.1_Rabies_lyssavirus_isolate_92-350_nucleoprotein',
'MK760739.1_Rabies_lyssavirus_isolate_92-75_nucleoprotein',
'MK760764.1_Rabies_lyssavirus_isolate_93-A-88_nucleoprotein',
'MK828539.1_Maize_mosaic_nucleorhabdovirus',
'MK948541.1_Physostegia_chlorotic_mottle_virus_isolate_JKI_ID_31401',
'MN013386.1_Guadeloupe_Culex_rhabdovirus_strain_2017-PB-CQM-1-3',
'MN013387.1_Guadeloupe_Culex_rhabdovirus_strain_2017-PB-CQF-1-5',
'MN013388.1_Guadeloupe_Culex_rhabdovirus_strain_2017-PB-CQF-5',
'MN013389.1_Guadeloupe_Culex_rhabdovirus_strain_2017-PB-CQM-1-4',
'MN013390.1_Guadeloupe_Culex_rhabdovirus_strain_2017-PB-CQM-1-5',
'MN013391.1_Guadeloupe_Culex_rhabdovirus_strain_2017-PB-CQM-5',
'MN013392.1_Guadeloupe_Culex_rhabdovirus_strain_2017-PB-CQM-1-1',
'MN013393.1_Guadeloupe_Culex_rhabdovirus_strain_2016-Ab-CQF',
'NC_001542.1_Rabies_virus',
'NC_001615.3_Sonchus_yellow_net_virus_complete_genome_6',
'NC_003243.1_Australian_bat_lyssavirus',
'NC_003746.1_Rice_yellow_stunt_virus',
'NC_005975.1_Maize_mosaic_virus',
'NC_006429.1_Mokola_virus',
'NC_006942.1_Taro_vein_chlorosis_virus',
'NC_007642.1_Lettuce_necrotic_yellows_virus',
'NC_008514.1_Siniperca_chuatsi_rhabdovirus',
'NC_009527.1_European_bat_lyssavirus_1',
'NC_009528.2_European_bat_lyssavirus_2_isolate_RV1333',
'NC_009609.1_Orchid_fleck_virus_genomic_RNA',
'NC_011532.1_Lettuce_yellow_mottle_virus',
'NC_011558.1_Lettuce_big-vein_associated_virus_RNA_1',
'NC_016136.1_Potato_yellow_dwarf_virus',
'NC_018381.2_Persimmon_virus_A_viral_cRNA',
'NC_020804.1_Tibrogargan_virus_strain_CS132',
'NC_020805.1_Chandipura_virus_isolate_CIN_0451',
'NC_020807.1_Lagos_bat_virus_isolate_0406SEN',
'NC_020808.1_Aravan_virus',
'NC_020810.1_Duvenhage_virus_isolate_86132SA',
'NC_022580.1_Drosophila_obscura_sigma_virus_10A',
'NC_022755.1_American_bat_vesiculovirus_TFFN-2013_isolate_liver2008',
'NC_024473.1_Vesicular_stomatitis_New_Jersey_virus_isolate_NJ1184HDB',
'NC_025251.1_Bokeloh_bat_lyssavirus_isolate_21961',
'NC_025253.1_Farmington_virus_strain_CT_114',
'NC_025359.1_Moussa_virus_isolate_C23',
'NC_025365.1_Shimoni_bat_virus',
'NC_025378.1_Yug_Bogdanovac_virus',
'NC_025382.1_Spodoptera_frugiperda_rhabdovirus_isolate_Sf',
'NC_025385.1_Khujand_lyssavirus',
'NC_025389.1_Eggplant_mottled_dwarf_virus_isolate_Agapanthus',
'NC_025391.1_Almpiwar_virus_isolate_MRM4059',
'NC_025397.1_Coastal_Plains_virus_strain_DPP53',
'NC_025399.1_Oak-Vale_virus_strain_CSIRO_1342',
'NC_025405.1_Niakha_virus_isolate_DakArD_88909',
'NC_025408.1_Lyssavirus_Ozernoe',
'NC_028230.1_Inhangapi_virus_strain_BEAR177325',
'NC_028231.1_Datura_yellow_vein_virus',
'NC_028232.1_Walkabout_Creek_virus_isolate_CS1056',
'NC_028234.1_Santa_barbara_virus_strain_AR775619',
'NC_028237.2_Alfalfa_dwarf_virus_isolate_Manfredi',
'NC_028241.1_Yata_virus_isolate_DakArB_2181',
'NC_028255.1_Cocal_virus_Indiana_2',
'NC_030451.1_Diachasmimorpha_longicaudata_rhabdovirus_isolate_UGA',
'NC_031079.1_Bole_Tick_Virus_2_strain_BL076_nucleocapsid_N',
'NC_031083.1_Huangpi_Tick_Virus_3_strain_H124-2_nucleocapsid_N',
'NC_031093.1_Sanxia_Water_Strider_Virus_5_strain_SXSSP11_nucleocapsid_N',
'NC_031227.1_Wuhan_Insect_virus_5_strain_YCYC02_nucleocapsid_N',
'NC_031236.1_Wuhan_Insect_virus_7_strain_WHYC02_nucleocapsid_N',
'NC_031272.1_Tacheng_Tick_Virus_7_strain_TCRP-3_ORF1_ORF1',
'NC_031273.1_Taishun_Tick_Virus_strain_BL198_nucleocapsid_N',
'NC_031276.1_Wuhan_Ant_Virus_strain_WHMY02_RNA-dependent_RNA_polymerase_L_gene',
'NC_031283.1_Wuhan_House_Fly_Virus_2_strain_SYY4-5_ORF1_ORF1',
'NC_031301.1_Wuhan_Louse_Fly_Virus_5_strain_BFJSC-5_nucleocapsid_N',
'NC_031303.1_Wuhan_Mosquito_Virus_9_strain_JX1-13_ORF1_ORF1',
'NC_031691.1_Gata_virus_strain_M4_L_protein',
'NC_031955.1_Lleida_bat_lyssavirus_isolate_RV3208',
'NC_031957.1_UNVERIFIED',
'NC_031988.1_Gannoruwa_bat_lyssavirus_isolate_RV3266',
'NC_033705.1_Xinzhou_nematode_virus_4_strain_XZSJSC65771_putative_nucleoprotein',
'NC_034240.1_Tomato_yellow_mottle-associated_virus',
'NC_034529.1_Sena_Madureira_virus_nucleoprotein',
'NC_034533.1_Landjia_virus_nucleoprotein',
'NC_034534.1_Rochambeau_virus_nucleoprotein',
'NC_034535.1_Barur_virus_nucleoprotein',
'NC_034545.1_Mount_Elgon_bat_virus_nucleoprotein',
'NC_034546.1_Sweetwater_Branch_virus_nucleoprotein',
'NC_034548.1_Oita_virus_nucleoprotein',
'NC_034549.1_Klamath_virus_nucleoprotein',
'NC_034550.1_Chaco_virus_nucleoprotein',
'NC_036390.1_Maize_Iranian_mosaic_nucleorhabdovirus',
'NC_038236.1_Vesicular_stomatitis_Indiana_virus_strain_98COE',
'NC_038278.1_Drosophila_affinis_sigmavirus_nucleocapsid_protein_N',
'NC_038280.1_Drosophila_immigrans_sigmavirus_strain_SCM45623_nucleocapsid_protein',
'NC_038281.1_Drosophila_melanogaster_sigma_virus_HAP23',
'NC_038282.1_Ekpoma_virus_1_isolate_EKV-1',
'NC_038283.1_Ekpoma_virus_2_isolate_EKV-2',
'NC_038285.1_Carajas_virus_nucleoprotein',
'NC_038287.1_Radi_virus_nucleoprotein',
'NC_038755.1_Coffee_ringspot_virus_strain_Lavras_segment_RNA2',
'NC_039020.1_Kanyawara_virus_isolate_MPK004_nucleoprotein',
'NC_039021.1_Beatrice_Hill_virus_isolate_CSIRO_25',
'NC_039206.1_Jurona_virus_nucleoprotein',
'NC_040602.1_Menghai_rhabdovirus_isolate_Menghai',
'NC_043649.1_Clerodendrum_chlorotic_spot_virus_isolate_Prb1_segment_RNA2'),
nyami = c('FJ554525.1_Midway_virus_isolate_RML47153',
'FJ554526.1_Nyamanini_virus_isolate_tick_39',
'HM849038.1_Soybean_cyst_nematode_midway_virus_N-protein',
'KF530058.1_Sierra_Nevada_virus',
'KM817644.1_Wenzhou_Crab_Virus_1_strain_RBX2_nucleocapsid_N',
'KX257488.1_Orinoco_virus_strain_UW1',
'KX884406.1_Beihai_rhabdo-like_virus_4_strain_BHJP58499_putative_nucleoprotein',
'KX884407.1_Beihai_rhabdo-like_virus_5_strain_BHJP63888_putative_nucleoprotein',
'KX884408.1_Beihai_rhabdo-like_virus_3_strain_BHNXC39077_putative_nucleoprotein',
'MG550265.1_Soybean_cyst_nematode_nyami-like_virus_isolate_6269845N_nucleoprotein',
'MG550266.1_Soybean_cyst_nematode_nyami-like_virus_isolate_6269844N_nucleoprotein',
'MG550267.1_Soybean_cyst_nematode_nyami-like_virus_isolate_6232814-16N_nucleoprotein',
'MH477287.1_Formica_fusca_virus_1',
'MK971153.1_San_Jacinto_virus_isolate_DO-200',
'NC_012702.1_Midway_virus',
'NC_012703.1_Nyamanini_virus',
'NC_024376.1_Sierra_Nevada_virus',
'NC_024702.1_Soybean_cyst_nematode_midway_virus_N-protein',
'NC_031275.1_Wenzhou_Crab_Virus_1_strain_RBX2_nucleocapsid_N',
'NC_032543.1_Beihai_rhabdo-like_virus_4_strain_BHJP58499_putative_nucleoprotein',
'NC_032544.1_Beihai_rhabdo-like_virus_5_strain_BHJP63888_putative_nucleoprotein',
'NC_043485.1_Orinoco_virus_strain_UW1',
'NC_043486.1_Beihai_rhabdo-like_virus_3_strain_BHNXC39077_putative_nucleoprotein'),
lispi = c('KM817632.1_Lishi_Spider_Virus_2_strain_LSZZ-4_ORF1_ORF1',
'NC_031259.1_Lishi_Spider_Virus_2_strain_LSZZ-4_ORF1_ORF1'),
xinmo = c('KM817638.1_Shuangao_Fly_Virus_2_strain_QSA05_RNA-dependent_RNA_polymerase_L_gene',
'NC_043484.1_Drosophila_unispina_virus_1_ORF1'),
mymona = c('KT598228.1_Soybean_leaf-associated_negative-stranded_RNA_virus_3_isolate_SaNSRV1-1',
'LC466007.1_Lentinula_edodes_negative-strand_RNA_virus_1_HG3_RNA',
'MH648611.1_Botrytis_cinerea_mymonavirus_1_isolate_Ecan17-2'),
narna = c('MN034260.1_Narnavirus_sp._isolate_H2_Bulk_Litter_12_scaffold_23_hypothetical_protein_H2BulkLitter1223_000001_gene',
'MN035123.1_Narnavirus_sp._isolate_H3_Rhizo_Litter_15_scaffold_62_sequence_1',
'MN035214.1_Narnavirus_sp._isolate_H2_Bulk_Litter_12_scaffold_176_sequence_1'),
polycipi = c('MH477288.1_Lasius_neglectus_virus_2'),
arto = c('KX884420.1_Hubei_rhabdo-like_virus_8_strain_QTM19395_RNA-dependent_RNA_polymerase_gene',
'KX884421.1_Hubei_rhabdo-like_virus_6_strain_QTM24798_hypothetical_protein_and_RNA-dependent_RNA_polymerase_genes',
'KX884446.1_Hubei_rhabdo-like_virus_5_strain_WHSFII19440_RNA-dependent_RNA_polymerase_gene',
'NC_038269.1_Pteromalus_puparum_negative-strand_RNA_virus_1'),
unclas = c('KM817631.1_Jingshan_Fly_Virus_2_strain_JSY-4_RNA-dependent_RNA_polymerase_L_gene',
'KM817633.1_Sanxia_Water_Strider_Virus_4_strain_SXSSP12_ORF1_ORF1',
'KM817637.1_Shuangao_Bedbug_Virus_2_strain_SACC-1_ORF1_ORF1',
'KM817639.1_Shuangao_Insect_Virus_6_strain_QSA10_RNA-dependent_RNA_polymerase_L_gene',
'KM817641.1_Tacheng_Tick_Virus_6_strain_TCRP-2_ORF1_ORF1',
'KM817655.1_Wuhan_Louse_Fly_Virus_8_strain_BFJSC-6_RNA-dependent_RNA_polymerase_L_gene',
'KX580901.1_Berant_virus_ORFX_gene',
'KX884405.1_Beihai_rhabdo-like_virus_6_strain_BHJJX49420_putative_nucleoprotein',
'KX884410.1_Beihai_barnacle_virus_8_strain_BHTH14652_hypothetical_protein_1',
'KX884411.1_Beihai_barnacle_virus_7_strain_BHTH16013_hypothetical_protein_1',
'KX884412.1_Beihai_rhabdo-like_virus_1_strain_BHTSS15727_hypothetical_protein_1',
'KX884413.1_Beihai_rhabdo-like_virus_2_strain_BHTSS7258_hypothetical_protein_1',
'KX884414.1_Shayang_ascaridia_galli_virus_2_strain_HC21241_hypothetical_protein_1',
'KX884417.1_Hubei_rhabdo-like_virus_3_strain_QCM135517_hypothetical_protein_1',
'KX884418.1_Hubei_odonate_virus_10_strain_QTM133243_hypothetical_protein_1',
'KX884422.1_Hubei_rhabdo-like_virus_1_strain_QTM25107_hypothetical_protein_1',
'KX884440.1_Shayang_ascaridia_galli_virus_2_strain_SYJFC48550_putative_nucleoprotein',
'KX884441.1_Wuchan_romanomermis_nematode_virus_2_strain_WCLSXC55347_hypothetical_protein_1',
'KX884443.1_Hubei_myriapoda_virus_7_strain_WGML146453_hypothetical_protein_1',
'KX884447.1_Hubei_rhabdo-like_virus_2_strain_WHSWHC60518_hypothetical_protein_1',
'KX884448.1_Hubei_rhabdo-like_virus_9_strain_WHZHC73015_hypothetical_protein_1',
'KX884450.1_Wenling_crustacean_virus_10_strain_WLJQ101844_hypothetical_protein_1',
'KX884456.1_Wenling_crustacean_virus_11_strain_WLJQ201798_hypothetical_protein_1',
'KX884457.1_Wenling_crustacean_virus_12_strain_WLJQ47777_putative_nucleoprotein',
'LN713933.1_Black_grass_varicosavirus-like_virus_segment_RNA_1_1',
'MF287670.1_Formica_exsecta_virus_4_ORF5_gp5',
'MF444285.1_Sclerotinia_sclerotiorum_negative-stranded_RNA_virus_7_isolate_SsNSRV7_RNA-dependent_RNA_polymerase_gene',
'MG489864.1_Lepeophtheirus_virus_LS24',
'MK026565.1_Fairlight_virus_segment_1_RNA-dependent_RNA_polymerase_and_glycoprotein_genes',
'MK026568.1_Quarantine_head_virus_segment_1_glycoprotein_and_RNA-dependent_RNA_polymerase_genes',
'MK584853.1_Penicillium_glabrum_negative-stranded_RNA_virus_1_isolate_CREA-VE-21SY1',
'MK584858.1_Penicillium_adametzioides_negative-stranded_RNA_virus_1_isolate_CREA-VE-8SY1',
'NC_031088.1_Sanxia_Water_Strider_Virus_4_strain_SXSSP12_ORF1_ORF1',
'NC_031217.1_Shuangao_Bedbug_Virus_2_strain_SACC-1_ORF1_ORF1',
'NC_031270.1_Tacheng_Tick_Virus_6_strain_TCRP-2_ORF1_ORF1',
'NC_031304.1_Wuhan_Tick_Virus_1_strain_X78-2_nucleocapsid_N',
'NC_032430.1_Beihai_barnacle_virus_8_strain_BHTH14652_hypothetical_protein_1',
'NC_032432.1_Beihai_barnacle_virus_7_strain_BHTH16013_hypothetical_protein_1',
'NC_032541.1_Beihai_rhabdo-like_virus_6_strain_BHJJX49420_putative_nucleoprotein',
'NC_032555.1_Beihai_rhabdo-like_virus_1_strain_BHTSS15727_hypothetical_protein_1',
'NC_032558.1_Beihai_rhabdo-like_virus_2_strain_BHTSS7258_hypothetical_protein_1',
'NC_032739.1_Wenling_crustacean_virus_10_strain_WLJQ101844_hypothetical_protein_1',
'NC_032781.1_Wenling_crustacean_virus_11_strain_WLJQ201798_hypothetical_protein_1',
'NC_032793.1_Wenling_crustacean_virus_12_strain_WLJQ47777_putative_nucleoprotein',
'NC_032849.1_Hubei_orthoptera_virus_5_strain_ZCM94262_hypothetical_protein_1',
'NC_032929.1_Hubei_rhabdo-like_virus_3_strain_QCM135517_hypothetical_protein_1',
'NC_032944.1_Hubei_odonate_virus_10_strain_QTM133243_hypothetical_protein_1',
'NC_032971.1_Hubei_rhabdo-like_virus_1_strain_QTM25107_hypothetical_protein_1',
'NC_033070.1_Hubei_dimarhabdovirus_virus_1_strain_SCM51525_putative_nucleoprotein',
'NC_033182.1_Shayang_ascaridia_galli_virus_2_strain_SYJFC48550_putative_nucleoprotein',
'NC_033261.1_Hubei_rhabdo-like_virus_2_strain_WHSWHC60518_hypothetical_protein_1',
'NC_033267.1_Hubei_rhabdo-like_virus_9_strain_WHZHC73015_hypothetical_protein_1',
'NC_033436.1_Wuchan_romanomermis_nematode_virus_2_strain_WCLSXC55347_hypothetical_protein_1',
'NC_033703.1_Xinzhou_dimarhabdovirus_virus_1_strain_XZSJSC65538_hypothetical_protein',
'NC_035133.1_Culex_mononega-like_virus_2_strain_mos191gb23464'))
cols <- c("NODE" = "#ff7f0e",
"SRA" = "#1f77b4",
"rhabdo"="#2ca02c",
"nyami"="#2ca02c",
"lispi"="#2ca02c",
"xinmo"="#2ca02c",
"mymona"="#2ca02c",
"narna"="#2ca02c",
"polycipi" = "#2ca02c",
"arto" = "#2ca02c",
"unclas" = "#7f7f7f",
"0" = "#7f7f7f")
cols2 <- c("NODE" = "#ff7f0e",
"SRA" = "#1f77b4",
"rhabdo"="blue",
"nyami"="red",
"lispi"="orange",
"xinmo"="purple",
"mymona"="green",
"narna"="black",
"polycipi" = "orange",
"arto" = "lightgreen",
"unclas" = "#7f7f7f",
"0" = "#7f7f7f")
rhabdo <- groupOTU(rhabdo, cls)
rhabdotree <- ggtree(rhabdo, aes(color=group), size=5) +
#geom_nodelab(aes(label=round(as.numeric(posterior), 2)),alpha=0.5,color='black', size=2, nudge_x=0.01) +
geom_nodepoint(aes(subset = posterior > 0.8), color='black',size=1) +
geom_tiplab() +
#theme(legend.position = c(0.1,0.9),
#      legend.title = element_blank(), # no title
#      legend.key = element_blank()) +
xlim(0,3) +
geom_treescale() +
scale_colour_manual(values = cols)
rhabdotree
r1 <- collapse(rhabdotree, node=849) + geom_point2(aes(subset=(node==849)), shape=17, size=5, fill="brown")
r2 <- collapse(r1, node=1212) + geom_point2(aes(subset=(node==1212)), shape=17, size=5, fill="brown")
r3 <- collapse(r2, node=713) + geom_point2(aes(subset=(node==713)), shape=17, size=5, fill="brown")
r4 <- collapse(r3, node=696) + geom_point2(aes(subset=(node==696)), shape=17, size=5, fill="brown")
r5 <- collapse(r4, node=800) + geom_point2(aes(subset=(node==800)), shape=17, size=5, fill="brown")
rhabdotree <- r5
rhabdotree
sinaiNS <- read.beast("../data/MCC/SinaiNS.mcctree")
cls <- list(NODE = c('BeeP-49-2013_NODE_27_length_6327_cov_6_608480_3'),
Alphatetraviridae = c('EU345431.1_1','KX423453.1_1','NC_001981.1_1','NC_005898.1_1','U18246.1_1','AY594352.1_1'),
Astroviridae = c('KX907135.1_1','NC_032426.1_1','NC_040647.1_1'),
Hepeviridae = c('MF190001.1_1','NC_040710.1_1'),
Bromoviridae = c('NC_009537.1_1'))
sinaiNS <- groupOTU(sinaiNS, cls)
cols <- c("NODE" = "#ff7f0e","Alphatetraviridae"="#2ca02c","Astroviridae"="#2ca02c","Hepeviridae"="#2ca02c","Bromoviridae"="#2ca02c")
sinaiNStree <- ggtree(sinaiNS, aes(color=group), size=5) +
#geom_nodelab(aes(label=round(as.numeric(posterior), 2)),alpha=0.5,color='black', size=2, nudge_x=0.01) +
geom_nodepoint(aes(subset = posterior > 0.8), color='black',size=1) +
geom_tiplab() +
#theme(legend.position = c(0.1,0.9),
#      legend.title = element_blank(), # no title
#      legend.key = element_blank()) +
xlim(0,3) +
geom_treescale() +
scale_colour_manual(values = cols)
sinaiNStree
sinaiS <- read.beast("MCCtrees/SinaiS.mcctree")
cls <- list(NODE = c('BP11_NODE_2_length_5933_cov_8664_753785_2', 'BP35_NODE_8_length_6159_cov_3073_471514_3', 'BeeP-34-2013_NODE_11_length_5700_cov_81_138894_3', 'BeeP-34-2013_NODE_8_length_5876_cov_117_977410_3'),
SRA = c('SRR1239309.Contig_10906_56.5422_length_5835_3', 'SRR1239309.Contig_3402_33.8366_length_5852_3', 'SRR1239310.Contig_18500_86.3069_length_5976_3', 'SRR3927501.Contig_20_4621.33_length_5753_3', 'SRR5109829.Contig_5052_19.3642_length_5832_3', 'SRR5117449.Contig_4792_738.395_length_5543_3', 'SRR6031640.Contig_16980_3187.18_length_5924_3', 'SRR6031648.Contig_11953_83.802_length_5935_3', 'SRR6833958.Contig_36829_28.5413_length_5784_3', 'SRR806508.Contig_22923_17.5662_length_5787_3', 'SRR806508.Contig_4561_28.5866_length_5893_3', 'SRR806550.Contig_15712_2565.35_length_5987_3'),
Sinai1 = c('HQ871931.2_2','KY465697.1_2','KY465698.1_2','KY465699.1_2','KY465700.1_2','KY465701.1_2','KY465702.1_2','KY465703.1_2','KY465704.1_2','KY465705.1_2','LR596015.1_2','NC_035466.1_2'),
Sinai2 = c('HQ888865.2_2','KY465706.1_2','KY465707.1_2','KY465708.1_2','KY465709.1_2','KY465710.1_2','KY465711.1_2','KY465712.1_2','KY465713.1_2','LR655824.1_2','NC_035467.1_2'),
Sinai = c('KM886902.1_2','KM886903.1_2','KM886904.1_2','KM886905.1_2','KX883223.1_2','KY465714.1_2','KY465715.1_2','KY465716.1_1','KY465717.1_2','KY465719.1_1','KY465720.1_2','MG918125.1_2','NC_032433.1_2'),
SinaiTO = c('KY354241.1_2'),
SinaiNE = c('KY354242.1_2','NC_035113.1_2'),
SinaiSA1 = c('KY354243.1_2','NC_035111.1_2'),
SinaiSA2 = c('KY354244.1_2', 'NC_035112.1_2'),
Sinai3 = c('MH267699.1_2','MH267700.1_2'))
sinaiS <- groupOTU(sinaiS, cls)
cols <- c("NODE" = "#ff7f0e","SRA" = "#1f77b4","Sinai1" = "#2ca02c","Sinai2" = "#2ca02c","Sinai" = "#2ca02c","SinaiTO" = "#2ca02c","SinaiNE" = "#2ca02c","SinaiSA1" = "#2ca02c","SinaiSA2" = "#2ca02c", "Sinai3" = "#2ca02c")
sinaiStree <- ggtree(sinaiS, aes(color=group),size=5) +
#geom_nodelab(aes(label=round(as.numeric(posterior), 2)),alpha=0.5,color='black', size=2, nudge_x=0.01) +
geom_nodepoint(aes(subset = posterior > 0.8), color='black',size=1) +
#geom_tiplab() +
#theme(legend.position = c(0.1,0.9),
#      legend.title = element_blank(), # no title
#      legend.key = element_blank()) +
xlim(0,1) +
geom_treescale() +
scale_colour_manual(values = cols)
sinaiS
sinaiS
sinaiStree
toti <- read.beast("MCCtrees/Toti.mcctree")
cls <- list(NODE = c('BP23_NODE_31_length_5100_cov_72_148022_1_20_2503_-1_ID=1_1_partial=00_start_type=ATG_rbs_motif=None_rbs_spacer=None_gc_cont=0.518',
'BeeP-34-2013_NODE_9_length_5861_cov_32_563451_2_4007_5821_1_ID=2_2_partial=00_start_type=ATG_rbs_motif=CCGCC_rbs_spacer=6bp_gc_cont=0.530'),
SRA = c('SRR1503019.Contig_22032_542.914_length_5984_1_198_2591_-1_ID=3_1_partial=00_start_type=ATG_rbs_motif=None_rbs_spacer=None_gc_cont=0.427',
'SRR6456322.Contig_9844_124.905_length_7917_1_234_5294_1_ID=6_1_partial=00_start_type=ATG_rbs_motif=None_rbs_spacer=None_gc_cont=0.588'),
victorivirus = c('NC_001963.1_2_2574_5090_1_ID=9_2_partial=00_start_type=ATG_rbs_motif=None_rbs_spacer=None_gc_cont=0.588',
'NC_001964.1_2_2658_5135_1_ID=10_2_partial=00_start_type=ATG_rbs_motif=CCGCC_rbs_spacer=12bp_gc_cont=0.597',
'NC_003607.2_2_2605_5112_1_ID=25_2_partial=00_start_type=ATG_rbs_motif=None_rbs_spacer=None_gc_cont=0.554',
'NC_003876.1_2_2603_5080_1_ID=12_2_partial=00_start_type=ATG_rbs_motif=None_rbs_spacer=None_gc_cont=0.543',
'NC_005074.1_2_2563_5100_1_ID=16_2_partial=00_start_type=ATG_rbs_motif=None_rbs_spacer=None_gc_cont=0.514',
'NC_006367.1_3_2818_5316_1_ID=22_3_partial=00_start_type=ATG_rbs_motif=None_rbs_spacer=None_gc_cont=0.562',
'NC_007523.1_2_2386_4875_1_ID=23_2_partial=00_start_type=ATG_rbs_motif=None_rbs_spacer=None_gc_cont=0.564',
'NC_010246.1_3_2638_5130_1_ID=30_3_partial=00_start_type=ATG_rbs_motif=CCCC_rbs_spacer=6bp_gc_cont=0.600',
'NC_014823.1_2_2604_5126_1_ID=32_2_partial=00_start_type=ATG_rbs_motif=None_rbs_spacer=None_gc_cont=0.595',
'NC_020997.1_2_2604_5075_1_ID=36_2_partial=00_start_type=ATG_rbs_motif=None_rbs_spacer=None_gc_cont=0.510',
'NC_021565.1_2_2664_5192_1_ID=39_2_partial=00_start_type=ATG_rbs_motif=CCGCC_rbs_spacer=8bp_gc_cont=0.576',
'NC_023547.1_3_2532_5021_1_ID=42_3_partial=00_start_type=ATG_rbs_motif=None_rbs_spacer=None_gc_cont=0.583',
'NC_024151.1_2_2735_5266_1_ID=44_2_partial=00_start_type=ATG_rbs_motif=None_rbs_spacer=None_gc_cont=0.567',
'NC_025366.1_2_2661_5144_1_ID=46_2_partial=00_start_type=ATG_rbs_motif=None_rbs_spacer=None_gc_cont=0.535',
'NC_026140.1_2_2713_5928_1_ID=49_2_partial=00_start_type=ATG_rbs_motif=None_rbs_spacer=None_gc_cont=0.608',
'NC_027209.1_3_2631_5108_1_ID=58_3_partial=00_start_type=ATG_rbs_motif=CCCC_rbs_spacer=6bp_gc_cont=0.585',
'NC_028477.1_2_2584_5166_1_ID=64_2_partial=00_start_type=ATG_rbs_motif=None_rbs_spacer=None_gc_cont=0.613',
'NC_030224.1_2_2554_5037_1_ID=73_2_partial=00_start_type=ATG_rbs_motif=CCGCC_rbs_spacer=15bp_gc_cont=0.592',
'NC_030392.1_2_2580_5081_1_ID=75_2_partial=00_start_type=ATG_rbs_motif=CCCC_rbs_spacer=3bp_gc_cont=0.480',
'NC_030867.1_2_2572_5055_1_ID=77_2_partial=00_start_type=ATG_rbs_motif=CCGCC_rbs_spacer=9bp_gc_cont=0.562',
'NC_038928.1_2_2599_5118_1_ID=96_2_partial=00_start_type=ATG_rbs_motif=None_rbs_spacer=None_gc_cont=0.565',
'NC_038929.1_2_2672_5176_1_ID=97_2_partial=00_start_type=ATG_rbs_motif=CCCC_rbs_spacer=5bp_gc_cont=0.543',
'NC_038930.1_2_2568_5051_1_ID=98_2_partial=00_start_type=ATG_rbs_motif=CCCC_rbs_spacer=4bp_gc_cont=0.589',
'NC_040653.1_3_2657_5185_1_ID=115_3_partial=00_start_type=ATG_rbs_motif=CCCC_rbs_spacer=6bp_gc_cont=0.618',
'NC_040793.1_2_2654_5143_1_ID=116_2_partial=00_start_type=ATG_rbs_motif=CCCC_rbs_spacer=6bp_gc_cont=0.547'),
toti = c('NC_009224.1_2_2631_5147_1_ID=27_2_partial=00_start_type=ATG_rbs_motif=None_rbs_spacer=None_gc_cont=0.518'),
unclas = c('NC_025218.2_2_261_5321_1_ID=52_2_partial=00_start_type=ATG_rbs_motif=None_rbs_spacer=None_gc_cont=0.588',
'NC_028948.1_2_2600_5077_1_ID=66_2_partial=00_start_type=ATG_rbs_motif=None_rbs_spacer=None_gc_cont=0.541',
'NC_029989.1_2_2652_5129_1_ID=72_2_partial=00_start_type=ATG_rbs_motif=CCCC_rbs_spacer=6bp_gc_cont=0.559',
'NC_032424.1_1_1_4680_1_ID=86_1_partial=10_start_type=Edge_rbs_motif=None_rbs_spacer=None_gc_cont=0.523',
'NC_032806.1_2_267_5117_1_ID=88_2_partial=00_start_type=ATG_rbs_motif=CCCC_rbs_spacer=5bp_gc_cont=0.543',
'NC_032819.1_1_2_4102_1_ID=89_1_partial=10_start_type=Edge_rbs_motif=None_rbs_spacer=None_gc_cont=0.474',
'NC_032851.1_1_101_4273_1_ID=87_1_partial=00_start_type=ATG_rbs_motif=None_rbs_spacer=None_gc_cont=0.421',
'NC_032931.1_1_2_4714_1_ID=90_1_partial=10_start_type=Edge_rbs_motif=None_rbs_spacer=None_gc_cont=0.538',
'NC_032948.1_1_72_5027_1_ID=91_1_partial=00_start_type=ATG_rbs_motif=None_rbs_spacer=None_gc_cont=0.578',
'NC_040530.1_2_2788_6090_1_ID=114_2_partial=00_start_type=ATG_rbs_motif=CCCC_rbs_spacer=9bp_gc_cont=0.610'))
toti <- groupOTU(toti, cls)
cols <- c("NODE" = "#ff7f0e","SRA" = "#1f77b4","victorivirus" = "#2ca02c","toti" = "#2ca02c","unclas" = "#7f7f7f")
totitree <- ggtree(toti, aes(color=group),size=5) +
#geom_nodelab(aes(label=round(as.numeric(posterior), 2)),alpha=0.5,color='black', size=2, nudge_x=0.01) +
geom_nodepoint(aes(subset = posterior > 0.8), color='black',size=1) +
geom_tiplab() +
#theme(legend.position = c(0.1,0.9),
#      legend.title = element_blank(), # no title
#      legend.key = element_blank()) +
xlim(0,5) +
geom_treescale() +
scale_colour_manual(values = cols)
totitree
tymo <- read.beast("MCCtrees/Tymo.mcctree")
cls <- list(NODE = c('BeeP-37-2013_NODE_30_length_5285_cov_819_119432_2_733_5283_-1_ID=1_2partial=01start_type=Edgerbs_motif=Nonerbs_spacer=Nonegc_cont=0.516',
'BeeP-43-2013_NODE_1_length_6265_cov_122_817873_1_2_5476_1_ID=2_1partial=10start_type=Edgerbs_motif=Nonerbs_spacer=Nonegc_cont=0.554',
'BeeP-49-2013_NODE_19_length_8271_cov_90_694044_4_2585_8269_-1_ID=3_4partial=01start_type=Edgerbs_motif=Nonerbs_spacer=Nonegc_cont=0.445',
'BeeP-49-2013_NODE_37_length_5188_cov_28_459010_1_3_2561_1_ID=4_1partial=10start_type=Edgerbs_motif=Nonerbs_spacer=Nonegc_cont=0.440'),
SRA = c('SRR1015503.Contig_4257_2592.36_length_5110_3_1670_5110_-1_ID=5_3partial=01start_type=Edgerbs_motif=Nonerbs_spacer=Nonegc_cont=0.465',
'SRR1015531.Contig_28871_50.2275_length_5084_1_3_5084_-1_ID=6_1partial=11start_type=Edgerbs_motif=Nonerbs_spacer=Nonegc_cont=0.461',
'SRR1503108.Contig_2059_227.433_length_6823_1_52_6726_-1_ID=7_1partial=00start_type=ATGrbs_motif=Nonerbs_spacer=Nonegc_cont=0.557',
'SRR5117444.Contig_2210_2.85334_length_5011_1_2_2641_1_ID=8_1partial=10start_type=Edgerbs_motif=Nonerbs_spacer=Nonegc_cont=0.382'),
tymoviridae = c('NC_001480.1_1_109_5628_1_ID=16_1partial=00start_type=ATGrbs_motif=Nonerbs_spacer=Nonegc_cont=0.540',
'NC_001746.1_1_86_5710_1_ID=17_1partial=00start_type=ATGrbs_motif=Nonerbs_spacer=Nonegc_cont=0.544',
'NC_001793.1_1_115_6315_1_ID=18_1partial=00start_type=ATGrbs_motif=GTGrbs_spacer=5bpgc_cont=0.631',
'NC_002588.1_1_147_5654_1_ID=21_1partial=00start_type=ATGrbs_motif=Nonerbs_spacer=Nonegc_cont=0.567',
'NC_002786.1_1_97_6180_1_ID=22_1partial=00start_type=ATGrbs_motif=Nonerbs_spacer=Nonegc_cont=0.624',
'NC_003634.1_1_157_5955_1_ID=26_1partial=00start_type=ATGrbs_motif=Nonerbs_spacer=Nonegc_cont=0.537',
'NC_006950.1_1_109_6675_1_ID=36_1partial=00start_type=ATGrbs_motif=Nonerbs_spacer=Nonegc_cont=0.576',
'NC_007609.1_1_419_5365_1_ID=39_1partial=00start_type=ATGrbs_motif=Nonerbs_spacer=Nonegc_cont=0.494',
'NC_009532.1_1_92_5542_1_ID=50_1partial=00start_type=ATGrbs_motif=Nonerbs_spacer=Nonegc_cont=0.598',
'NC_015522.1_1_1_6294_1_ID=82_1partial=10start_type=Edgerbs_motif=Nonerbs_spacer=Nonegc_cont=0.617',
'NC_020470.1_1_3_5642_1_ID=107_1partial=10start_type=Edgerbs_motif=Nonerbs_spacer=Nonegc_cont=0.498',
'NC_020471.1_1_111_5543_1_ID=108_1partial=00start_type=ATGrbs_motif=GTGrbs_spacer=9bpgc_cont=0.502',
'NC_021851.1_1_152_5578_1_ID=111_1partial=00start_type=ATGrbs_motif=Nonerbs_spacer=Nonegc_cont=0.501',
'NC_027631.1_1_2_5452_1_ID=130_1partial=10start_type=Edgerbs_motif=Nonerbs_spacer=Nonegc_cont=0.595',
'NC_029063.1_1_3_6242_1_ID=157_1partial=10start_type=Edgerbs_motif=Nonerbs_spacer=Nonegc_cont=0.598',
'NC_031692.1_1_1_6606_1_ID=172_1partial=10start_type=Edgerbs_motif=Nonerbs_spacer=Nonegc_cont=0.650',
'NC_034205.1_1_273_6629_1_ID=184_1partial=00start_type=ATGrbs_motif=Nonerbs_spacer=Nonegc_cont=0.586',
'NC_038328.1_1_195_6302_1_ID=314_1partial=00start_type=ATGrbs_motif=Nonerbs_spacer=Nonegc_cont=0.585',
'NC_040565.1_1_214_6603_1_ID=349_1partial=00start_type=ATGrbs_motif=Nonerbs_spacer=Nonegc_cont=0.488'),
Beta = c('NC_001948.1_1_62_6547_1_ID=19_1partial=00start_type=ATGrbs_motif=Nonerbs_spacer=Nonegc_cont=0.430',
'NC_003462.2_1_60_6611_1_ID=103_1partial=00start_type=ATGrbs_motif=Nonerbs_spacer=Nonegc_cont=0.427',
'NC_003877.1_1_74_5962_1_ID=27_1partial=00start_type=ATGrbs_motif=Nonerbs_spacer=Nonegc_cont=0.393',
'NC_005343.1_1_61_6039_1_ID=29_1partial=00start_type=ATGrbs_motif=Nonerbs_spacer=Nonegc_cont=0.455',
'NC_008020.1_1_75_6089_1_ID=41_1partial=00start_type=ATGrbs_motif=Nonerbs_spacer=Nonegc_cont=0.448',
'NC_009087.2_1_1_6249_1_ID=55_1partial=10start_type=Edgerbs_motif=Nonerbs_spacer=Nonegc_cont=0.455',
'NC_009383.1_1_2_6034_1_ID=48_1partial=10start_type=Edgerbs_motif=Nonerbs_spacer=Nonegc_cont=0.435',
'NC_009892.1_1_353_6442_1_ID=58_1partial=00start_type=ATGrbs_motif=Nonerbs_spacer=Nonegc_cont=0.432',
'NC_009991.1_1_1_6219_1_ID=59_1partial=10start_type=Edgerbs_motif=Nonerbs_spacer=Nonegc_cont=0.451',
'NC_011525.1_1_75_5417_1_ID=65_1partial=00start_type=ATGrbs_motif=Nonerbs_spacer=Nonegc_cont=0.452',
'NC_012038.1_1_59_5929_1_ID=68_1partial=00start_type=ATGrbs_motif=Nonerbs_spacer=Nonegc_cont=0.446',
'NC_013527.1_1_65_6058_1_ID=72_1partial=00start_type=ATGrbs_motif=Nonerbs_spacer=Nonegc_cont=0.443',
'NC_014821.1_1_61_6615_1_ID=79_1partial=00start_type=ATGrbs_motif=Nonerbs_spacer=Nonegc_cont=0.415',
'NC_017859.1_1_82_6015_1_ID=95_1partial=00start_type=ATGrbs_motif=Nonerbs_spacer=Nonegc_cont=0.473',
'NC_018175.1_1_71_5920_1_ID=97_1partial=00start_type=ATGrbs_motif=Nonerbs_spacer=Nonegc_cont=0.497',
'NC_018714.1_1_61_6612_1_ID=104_1partial=00start_type=ATGrbs_motif=Nonerbs_spacer=Nonegc_cont=0.422',
'NC_023892.1_1_64_6036_1_ID=116_1partial=00start_type=ATGrbs_motif=Nonerbs_spacer=Nonegc_cont=0.474',
'NC_025388.1_1_62_6130_1_ID=121_1partial=00start_type=ATGrbs_motif=Nonerbs_spacer=Nonegc_cont=0.445',
'NC_026616.2_1_65_5791_1_ID=125_1partial=00start_type=ATGrbs_motif=Nonerbs_spacer=Nonegc_cont=0.425',
'NC_027527.1_1_67_5793_1_ID=129_1partial=00start_type=ATGrbs_motif=Nonerbs_spacer=Nonegc_cont=0.431',
'NC_028868.1_1_2_6079_1_ID=148_1partial=10start_type=Edgerbs_motif=Nonerbs_spacer=Nonegc_cont=0.435',
'NC_028975.1_1_2_6130_1_ID=149_1partial=10start_type=Edgerbs_motif=Nonerbs_spacer=Nonegc_cont=0.437',
'NC_029085.1_1_61_6048_1_ID=158_1partial=00start_type=ATGrbs_motif=Nonerbs_spacer=Nonegc_cont=0.453',
'NC_029086.1_1_61_6033_1_ID=159_1partial=00start_type=ATGrbs_motif=Nonerbs_spacer=Nonegc_cont=0.454',
'NC_029088.1_1_2_6010_1_ID=160_1partial=10start_type=Edgerbs_motif=Nonerbs_spacer=Nonegc_cont=0.487',
'NC_031089.1_1_86_5992_1_ID=169_1partial=00start_type=ATGrbs_motif=Nonerbs_spacer=Nonegc_cont=0.419',
'NC_035203.1_1_2_6451_1_ID=219_1partial=10start_type=Edgerbs_motif=Nonerbs_spacer=Nonegc_cont=0.426',
'NC_038325.1_1_93_6026_1_ID=313_1partial=00start_type=ATGrbs_motif=Nonerbs_spacer=Nonegc_cont=0.401',
'NC_038966.1_1_62_6172_1_ID=315_1partial=00start_type=ATGrbs_motif=Nonerbs_spacer=Nonegc_cont=0.453',
'NC_040643.1_1_3_6476_1_ID=350_1partial=10start_type=Edgerbs_motif=Nonerbs_spacer=Nonegc_cont=0.426'),
Alpha = c('NC_003400.1_1_82_4977_1_ID=25_1partial=00start_type=ATGrbs_motif=Nonerbs_spacer=Nonegc_cont=0.530',
'NC_028649.1_1_81_4856_1_ID=137_1partial=00start_type=ATGrbs_motif=Nonerbs_spacer=Nonegc_cont=0.512'))
tymo <- groupOTU(tymo, cls)
cols <- c("NODE" = "#ff7f0e","SRA" = "#1f77b4","tymoviridae" = "#2ca02c","Beta" = "#2ca02c","Alpha" = "#2ca02c")
tymotree <- ggtree(tymo, aes(color=group),size=5) +
#geom_nodelab(aes(label=round(as.numeric(posterior), 2)),alpha=0.5,color='black', size=2, nudge_x=0.01) +
geom_nodepoint(aes(subset = posterior > 0.8), color='black',size=1) +
geom_tiplab() +
#theme(legend.position = c(0.1,0.9),
#      legend.title = element_blank(), # no title
#      legend.key = element_blank()) +
xlim(0,5) +
geom_treescale() +
scale_colour_manual(values = cols)
tymotree
lay <- rbind(c(1,1,2,2,3,4),
c(1,1,2,2,5,6),
c(1,1,2,2,7,8),
c(1,1,2,2,9,10))
testgrid <- grid.arrange(rhabdotree,picornatree,bunyatree,totitree, orthobeetree,orthosratree,sinaiNStree,sinaiStree,partititree,tymotree,layout_matrix =lay)
#ggsave("Treeplots/testgrid_notiplab.svg",testgrid, device = "svg", dpi=300, height=10,width=15, limitsize=FALSE)
# Run PCoA's, this takes a while.
library(vegan)
library("phyloseq")
library(ggplot2)
library(ape)
library(readr)
library(viridis)
library(dplyr)
library(svglite)
setwd("~/Bioinf/repo/Bee_euvir")
#Regen_coverage matrix (w/o) for consistency with SRA covmat
Flemishbee_df_denovo <- read.delim("../data/Pcoa/Flemishbee_df_denovo.tsv", row.names=1)
setwd("~/Bioinf/repo/Bee_euvir/scripts")
#Regen_coverage matrix (w/o) for consistency with SRA covmat
Flemishbee_df_denovo <- read.delim("../data/Pcoa/Flemishbee_df_denovo.tsv", row.names=1)
Contiglen <- read_delim("../data/Pcoa/sracontig_length.tsv", "\t", escape_double = FALSE, trim_ws = TRUE)
Flemishbee_df_norm <- sweep(Flemishbee_df_denovo, 1, Contiglen$X2, '/')
write.csv(Flemishbee_df_norm, file="../data/Pcoa/flembee_df_coverage_lengthnorm.tsv",quote = FALSE)
#Pcoa - Vir
VIRdf <- read.csv("../data/Pcoa/flembee_df_coverage_lengthnorm.tsv", row.names=1)
VIRdf <- t(VIRdf)
samstat <- read.csv("../data/Pcoa/Sample_status.csv", header=FALSE,row.names=1, sep=";")
colnames(samstat) <- c('Status')
vir_distmat <- vegdist(VIRdf, method='bray')
#Pcoa - SRA
gzip = gzfile("../data/Pcoa/SRA_df_denovo.tsv.gz")
SRAdf <- read.delim(gzip, row.names=1)
#Pcoa - SRA
gzip = gzfile("../data/Pcoa/SRA_df_denovo.tsv.gz")
SRAdf <- read.delim(gzip, row.names=1)
acc_EUtax_Country_RED <- read.csv("../data/Pcoa/acc_EUtax_Country.csv", row.names=1)
acc_EUtax_Country <- acc_EUtax_Country_RED
acc_EUtax_Country$TaxRed <- NULL
Contiglen <- read_delim("../data/Pcoa/sracontig_length.tsv", "\t", escape_double = FALSE, trim_ws = TRUE)
SRAdf_norm <- sweep(SRAdf, 1, Contiglen$X2, '/')
SRAdf_norm <- t(SRAdf_norm)
#Write out. This thing is relatively large.
write.csv(SRAdf_norm, file="../data/Pcoa/SRA_df_coverage_lengthnorm.tsv",quote = FALSE)
install.packages("europepmc")
install.packages("cowplot")
install.packages("tidyverse")
library("europepmc")
library("cowplot")
library("tidyverse")
epmc_res <- epmc_hits_trend(query ="Bee virus", period=2000:2020)
epmc_res
ggplot() + geom_bar(x='year',y='query_hits')
ggplot() + geom_point(x='year',y='query_hits')
ggplot() + geom_point(x='year',y='query_hits', data=epmc_res)
plot(epmc_res$year, epmc_res$query_hits)
plot(epmc_res$year, epmc_res$query_hits/epmc_res$all_hits)
epmc_res <- epmc_hits_trend(query ="Bee virus", period=1990:2020)
epmc_res
ggplot() + geom_point(x='year',y='query_hits', data=epmc_res)
plot(epmc_res$year, epmc_res$query_hits/epmc_res$all_hits)
epmc_res <- epmc_hits_trend(query ="apis", period=1990:2020)
plot(epmc_res$year, epmc_res$query_hits/epmc_res$all_hits)
plot(epmc_res$year, epmc_res$query_hits)
epmc_res <- epmc_hits_trend(query ="apis + virus", period=1990:2020)
plot(epmc_res$year, epmc_res$query_hits)
microbvir <- epmc_hits_trend(query = "microbiome", period=1990:2020)
ggplot(aes(data=apisvir)) + geom_point(x='year',y='query_hits')
?class(apisvir)
class(apisvir)
apisvir <- epmc_hits_trend(query ="apis + virus", period=1990:2020)
ggplot(aes(data=apisvir)) + geom_point(x='year',y='query_hits')
?class(apisvir)
class(apisvir)
ggplot(aes(data=as.data.frame(apisvir))) + geom_point(x='year',y='query_hits')
ggplot(aes(data=as.data.frame(apisvir))) + geom_point(x='year',y='query_hits')
ggplot() + geom_point(x=apisvir['year'],y=apisvir['query_hits'])
library("ggplot2")
library("europepmc")
apisvir <- epmc_hits_trend(query ="apis + virus", period=1990:2020)
microbvir <- epmc_hits_trend(query = "microbiome", period=1990:2020)
ggplot() + geom_point(x=apisvir,y=apisvir)
dev.off()
ggplot() + geom_point(x=apisvir$year,y=apisvir$query_hits)
ggplot() + geom_bar(x=apisvir$year,y=apisvir$query_hits)
plot(apisvir$year, apisvir$query_hits)
apisvir <- epmc_hits_trend(query ="apis + virus", period=1990:2019)
microbvir <- epmc_hits_trend(query = "microbiome", period=1990:2019)
